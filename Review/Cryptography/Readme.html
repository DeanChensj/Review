<!DOCTYPE html>
<html>
<head>
<title>密码学</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
/* GitHub stylesheet for MarkdownPad (http://markdownpad.com) */
/* Author: Nicolas Hery - http://nicolashery.com */
/* Version: b13fe65ca28d2e568c6ed5d7f06581183df8f2ff */
/* Source: https://github.com/nicolahery/markdownpad-github */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

body {
  font-family: Helvetica, arial, freesans, clean, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}

/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-size: 28px;
  color: #000;
}

h2 {
  font-size: 24px;
  border-bottom: 1px solid #ccc;
  color: #000;
}

h3 {
  font-size: 18px;
}

h4 {
  font-size: 16px;
}

h5 {
  font-size: 14px;
}

h6 {
  color: #777;
  font-size: 14px;
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  color: #4183C4;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 12px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #f8f8f8;
  border: 1px solid #ccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

kbd {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #DDDDDD;
    background-image: linear-gradient(#F1F1F1, #DDDDDD);
    background-repeat: repeat-x;
    border-color: #DDDDDD #CCCCCC #CCCCCC #DDDDDD;
    border-image: none;
    border-radius: 2px 2px 2px 2px;
    border-style: solid;
    border-width: 1px;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    line-height: 10px;
    padding: 1px 4px;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #ccc;
  background-color: #fff;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

/* IMAGES
=============================================================================*/

img {
  max-width: 100%
}
</style>
</head>
<body>
<div class="md-section-divider"></div>

<div class="md-section-divider"></div>

<h1 data-anchor-id="kog0" id="密码学">密码学</h1>

<p data-anchor-id="c4ms"><code class="code-black">复习</code></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="xxid" id="lec4-常用密码算法">Lec4 常用密码算法</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="rhcv" id="双重des-三重des-中间相遇攻击">双重DES 三重DES 中间相遇攻击</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="gamm" id="1-中间相遇攻击">1. 中间相遇攻击</h4>

<div class="md-section-divider"></div>

<h5 data-anchor-id="fchd" id="11-原理">1.1 原理</h5>

<p data-anchor-id="zc2z"><img src="http://i57.tinypic.com/24pav41.png" alt="中间相遇攻击" title=""></p>

<div class="md-section-divider"></div>

<h5 data-anchor-id="dih0" id="12-算法步骤">1.2 算法步骤</h5>

<pre data-anchor-id="iavb" class="code-black"><code class="code-black">给定明文密文对(P, C)，对P按照K1的所有可能值（ 256 个）加密，所得结果按照X的值排序放在表T内
再对C用K2的所有可能值（ 256 个） 解密
每解密一次，将结果与T表中的值比较
如果等式成立，则用K1， K2依次对P加密，若结果为C，则获得正确密钥
</code></pre>

<div class="md-section-divider"></div>

<h5 data-anchor-id="umnl" id="13-结论">1.3 结论</h5>

<p data-anchor-id="eitt">使用中间相遇攻击，在已知两组明文密文对时，付出数量级为256的代价，可以成功攻击密钥长度为<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21874-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322612" style="width: 2.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.779em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.348em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322613"><span class="msubsup" id="MathJax-Span-322614"><span style="display: inline-block; position: relative; width: 1.758em; height: 0px;"><span style="position: absolute; clip: rect(1.546em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mn" id="MathJax-Span-322615" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.749em; left: 0.529em;"><span class="texatom" id="MathJax-Span-322616"><span class="mrow" id="MathJax-Span-322617"><span class="mn" id="MathJax-Span-322618" style="font-size: 70.7%; font-family: MathJax_Main;">112</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.248em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21874">2^{112}</script>的双重DES （CP. DES, 攻击数量级为<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21875-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322619" style="width: 1.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.348em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322620"><span class="msubsup" id="MathJax-Span-322621"><span style="display: inline-block; position: relative; width: 1.373em; height: 0px;"><span style="position: absolute; clip: rect(1.546em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mn" id="MathJax-Span-322622" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.749em; left: 0.529em;"><span class="texatom" id="MathJax-Span-322623"><span class="mrow" id="MathJax-Span-322624"><span class="mn" id="MathJax-Span-322625" style="font-size: 70.7%; font-family: MathJax_Main;">55</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.248em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21875">2^{55}</script>攻击）。</p>

<p data-anchor-id="1lv1"><strong>双重DES不能提高DES的安全性</strong></p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="qxsi" id="2-三重des">2. 三重DES</h4>

<p data-anchor-id="yz5g">为了对抗中间相遇攻击，使用三个密钥进行三次加密，使得已知明文攻击的代价上升为<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21876-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322626" style="width: 2.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.779em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.348em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322627"><span class="msubsup" id="MathJax-Span-322628"><span style="display: inline-block; position: relative; width: 1.758em; height: 0px;"><span style="position: absolute; clip: rect(1.546em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mn" id="MathJax-Span-322629" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.749em; left: 0.529em;"><span class="texatom" id="MathJax-Span-322630"><span class="mrow" id="MathJax-Span-322631"><span class="mn" id="MathJax-Span-322632" style="font-size: 70.7%; font-family: MathJax_Main;">112</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.248em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21876">2^{112}</script>数量级。<strong>（安全！）</strong></p>

<pre data-anchor-id="q0v0" class="code-black"><code class="code-black">    加密-解密-加密（EDE）
    加密：C = E_K1[D_K2[E_K1[P]]]
    解密：P = D_K1[E_K2[D_K1[C]]]
</code></pre>

<p data-anchor-id="ekbh">目前无可行攻击方法，穷举代价为 2^112 ,可对抗差分、线性攻击。</p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="if5y" id="3-aes">3. AES</h4>

<p data-anchor-id="j98d">不是Feistel结构，加密解密算法不同. <br>
对于加密和解密:</p>

<ul data-anchor-id="pptw">
<li>均以轮密钥加作为开始</li>
<li>9轮迭代，每轮包括 <br>
<ol><li>字节代换： S盒子 （代换，之前有密钥，属于混淆， 非线性）</li>
<li>行移位：简单置换 （属于扩散，线性）</li>
<li>列混淆：利用域GF(<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21877-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322633" style="width: 1.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.348em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322634"><span class="msubsup" id="MathJax-Span-322635"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(1.546em 1000em 2.5em -0.383em); top: -2.356em; left: 0em;"><span class="mn" id="MathJax-Span-322636" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.749em; left: 0.529em;"><span class="mn" id="MathJax-Span-322637" style="font-size: 70.7%; font-family: MathJax_Main;">8</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.248em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21877">2^8</script>)上的算术特性（属于扩散，线性）</li>
<li>轮密钥加：当前分组 XOR 轮密钥 （Vernam密码，线性）</li></ol></li>
<li>第10轮只包含 字节代换、行移位、轮密钥加,目的是满足算法的可逆性</li>
</ul>

<p data-anchor-id="pmsw">仅在轮密钥加阶段使用密钥, 每个阶段均可逆.</p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="0wxl" id="4-一些数学知识">4. 一些数学知识</h4>

<div class="md-section-divider"></div>

<h5 data-anchor-id="yr22" id="41-整数性质">4.1 整数性质</h5>

<ul data-anchor-id="5ry6">
<li>b可以整除a，记为b|a</li>
<li>最大公约数： <br>
<ul><li>d|a且d|b；</li>
<li>若f|a且f|b，则f|d；</li>
<li>将a和b的最大公约数记为gcd(a,b)，或(a,b)。</li></ul></li>
<li>最小公倍数 <br>
<ul><li>a|m且b|m；</li>
<li>若a|n且b|n，则m|n；</li>
<li>将a和b的最小公倍数记为lcm(a,b)，或[a,b]。 </li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h5 data-anchor-id="kwrj" id="42-euclid算法">4.2 Euclid算法</h5>

<pre data-anchor-id="xylr" class="code-black"><code class="code-black">【计算gcd(a,b)=d】
 Fact 1: gcd(a,b)= gcd(b, a-b)；
 Fact 2: 若a=qb+r，则gcd(a,b)= gcd(b,r)；
 Fact 3: 存在两个整数s,t，使得 gcd(a,b)=sa+tb
</code></pre>

<div class="md-section-divider"></div>

<h5 data-anchor-id="faki" id="43-群环域">4.3 群、环、域</h5>

<div class="md-section-divider"></div>

<h6 data-anchor-id="m7n2" id="431-群">4.3.1 群</h6>

<div class="md-section-divider"></div>

<h6 data-anchor-id="wsdu" id="设g是一个集合定义了ggg上的二元运算若满足下面条件称g-为一个群">设G是一个集合，定义了<strong>G×G→G</strong>上的二元运算•，若满足下面条件称(G, •)为一个群：</h6>

<ul data-anchor-id="bhgt">
<li>封闭性：若<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21878-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322638" style="width: 4.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.365em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.694em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322639"><span class="mi" id="MathJax-Span-322640" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322641" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322642" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-322643" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322644" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.294em; vertical-align: -0.315em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21878">a,b∈G</script>，则<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21879-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322645" style="width: 5.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.846em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.54em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322646"><span class="mi" id="MathJax-Span-322647" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322648" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322649" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-322650" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322651" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21879">a•b∈G</script>；</li>
<li>结合律：若<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21880-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322652" style="width: 5.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.231em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.694em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322653"><span class="mi" id="MathJax-Span-322654" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322655" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322656" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-322657" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322658" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="mo" id="MathJax-Span-322659" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322660" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.294em; vertical-align: -0.315em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21880">a,b,c∈G</script>，则<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21881-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322661" style="width: 12.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.231em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.339em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322662"><span class="mo" id="MathJax-Span-322663" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-322664" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322665" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322666" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-322667" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322668" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322669" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mo" id="MathJax-Span-322670" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322671" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mo" id="MathJax-Span-322672" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mo" id="MathJax-Span-322673" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-322674" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-322675" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322676" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mo" id="MathJax-Span-322677" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21881">(a•b)•c=a•(b•c)</script>；</li>
<li>单位元：存在一个元素<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21882-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322678" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.54em -0.394em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322679"><span class="mi" id="MathJax-Span-322680" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-322681" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322682" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21882">e∈G</script>，使得对于任意<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21883-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322683" style="width: 3.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.5em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.54em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322684"><span class="mi" id="MathJax-Span-322685" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322686" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322687" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21883">a∈G</script>有<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21884-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322688" style="width: 8.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.875em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.768em 1000em 2.511em -0.394em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322689"><span class="mi" id="MathJax-Span-322690" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-322691" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322692" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span><span class="mo" id="MathJax-Span-322693" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322694" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mo" id="MathJax-Span-322695" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322696" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">e</span><span class="mo" id="MathJax-Span-322697" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322698" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.717em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21884">e•a=a•e=a</script>;</li>
<li>逆元：对于任意<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21885-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322699" style="width: 3.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.5em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.54em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322700"><span class="mi" id="MathJax-Span-322701" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322702" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322703" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21885">a∈G</script>，都存在一个元素<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21886-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322704" style="width: 3.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.404em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.54em -0.393em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322705"><span class="mi" id="MathJax-Span-322706" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-322707" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322708" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.093em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21886">b∈G</script>，使得<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21887-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322709" style="width: 8.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.731em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322710"><span class="mi" id="MathJax-Span-322711" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322712" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322713" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-322714" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322715" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span><span class="mo" id="MathJax-Span-322716" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322717" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span><span class="mo" id="MathJax-Span-322718" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322719" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">e</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21887">a•b=b•a=e</script>。</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="ee24" id="432-交换群">4.3.2 交换群</h6>

<p data-anchor-id="wzsn">一个群(G, •)满足交换律，称作交换群。即<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21888-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322720" style="width: 5.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.942em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.694em -0.433em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322721"><span class="texatom" id="MathJax-Span-322722"><span class="mrow" id="MathJax-Span-322723"><span class="mo" id="MathJax-Span-322724" style="font-family: MathJax_Main;">∀</span></span></span><span class="mi" id="MathJax-Span-322725" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322726" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322727" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-322728" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mi" id="MathJax-Span-322729" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">G</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.294em; vertical-align: -0.315em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21888">∀a,b∈G</script>，有<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21889-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322730" style="width: 6.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322731"><span class="mi" id="MathJax-Span-322732" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-322733" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322734" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-322735" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322736" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span><span class="mo" id="MathJax-Span-322737" style="font-family: MathJax_Main; padding-left: 0.222em;">∙</span><span class="mi" id="MathJax-Span-322738" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21889">a•b=b•a</script>，交换群也称Abel群.</p>

<div class="md-section-divider"></div>

<h6 data-anchor-id="1vd7" id="433-有限群循环群">4.3.3 有限群、循环群</h6>

<ul data-anchor-id="jwaz">
<li>个数有限的-&gt;有限群。</li>
<li>若∃m使得<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21890-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322739" style="width: 3.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.029em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.536em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322740"><span class="msubsup" id="MathJax-Span-322741"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322742" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="mi" id="MathJax-Span-322743" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322744" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-322745" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.016em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21890">a^m=1</script>，称a的阶(order)有限；否则a的阶无穷.</li>
<li>当a的阶有限，使得<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21891-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322746" style="width: 3.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.029em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.536em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322747"><span class="msubsup" id="MathJax-Span-322748"><span style="display: inline-block; position: relative; width: 1.229em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322749" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="mi" id="MathJax-Span-322750" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322751" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-322752" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.016em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21891">a^m=1</script>的最小正整数m称为元素a的阶.</li>
<li>称形如{1,a, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21892-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322753" style="width: 1.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322754"><span class="msubsup" id="MathJax-Span-322755"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322756" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="mn" id="MathJax-Span-322757" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.222em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21892">a^2</script>,…,<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21893-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322758" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322759"><span class="msubsup" id="MathJax-Span-322760"><span style="display: inline-block; position: relative; width: 2.19em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322761" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="texatom" id="MathJax-Span-322762"><span class="mrow" id="MathJax-Span-322763"><span class="mi" id="MathJax-Span-322764" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-322765" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322766" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.222em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21893">a^{m-1}</script>}的群为循环群 <br>
<ul><li>元素a是群的生成元。</li></ul></li>
<li>设群G为阶为n的群，那么它的所有的子群的阶都可以整除n</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="ti6m" id="434-环">4.3.4 环</h6>

<p data-anchor-id="36gc">设R是一个集合， • 和+是定义在R上的两个运算。称(R,+, •)为一个环(Ring)， 如果满足条件：</p>

<ul data-anchor-id="ci2j">
<li>(R,+)是一个Abel加法群，其单位元用 0表示；</li>
<li>乘法对于加法满足分配律；</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="vde8" id="435-整环">4.3.5 整环</h6>

<ul data-anchor-id="0yrc">
<li>(R, • )可交换、有单位元、无零因子</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="th97" id="436-域">4.3.6 域</h6>

<ul data-anchor-id="1ghr">
<li>(F \ {0}, • )是一个Abel乘法群，其单位元用 1表示</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="jmok" id="437-有限域">4.3.7 有限域</h6>

<ul data-anchor-id="ywfy">
<li>最简单的有限域是整数环Z模一个素数p得到的余环Z/(p),由p个元素0,1,…,p-1组成,按模p相加和相乘。</li>
<li>有限域元素的数目称为有限域的阶。对于有限域，其元素的数目必然是素数的幂。而这个对应的素数成为有限域的特征。</li>
<li>所有阶数相同的有限域是同构的。也就是说，从本质上讲，给定有限域的阶，有限域就唯一确定了。</li>
</ul>

<div class="md-section-divider"></div>

<h6 data-anchor-id="irwf" id="438-summary">4.3.8 Summary</h6>

<p data-anchor-id="dl8z"><img src="http://i62.tinypic.com/rbwk6o.png" alt="Summary" title=""> <br>
整数的加法运算形成群{Z,0,+} <br>
整数对加法和乘法运算形成整环{Z,+,× ,0,1}</p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="qvoz" id="lec5-分组码应用模式伪随机数">Lec5 分组码应用模式，伪随机数</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="snhd" id="1-电码本模式ecb模式">1. 电码本模式（ECB模式）</h3>

<ul data-anchor-id="0zgi">
<li>用相同密钥对各个明文组分别加密，一次处理n位（如DES， n=64）明文每个n位明文对应唯一密文</li>
<li>明文长度大于n位：明文分段，最后一段可能需要填充</li>
<li>特征： 相同n位明文对应相同n位密文</li>
<li>用于单个数据的安全传输</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="wjnj" id="2-密码分组链接模式-cipher-block-chainingcbc">2. 密码分组链接模式 Cipher Block Chaining（CBC）</h3>

<ul data-anchor-id="h95t">
<li>将消息分为很多块，并通过加密进行链接。已加密的密文分组与当前的明文分组链接在一起。</li>
<li>每个密文分组均依据于之前的全部分组</li>
<li>使用初始向量IV</li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21894-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322767" style="width: 11.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.702em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322768"><span class="msubsup" id="MathJax-Span-322769"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322770" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322771" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322772" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322773" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322774" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-322775" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322776" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322777"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322778" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322780" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322781" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322782" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="texatom" id="MathJax-Span-322783"><span class="mrow" id="MathJax-Span-322784"><span class="mi" id="MathJax-Span-322785" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322786" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322787" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322788" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21894">C_i= E_K(P_i⊕ C_{i-1})</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21895-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322789" style="width: 4.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.702em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.666em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322790"><span class="msubsup" id="MathJax-Span-322791"><span style="display: inline-block; position: relative; width: 1.184em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322792" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mn" id="MathJax-Span-322793" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322794" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322795" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-322796" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.257em; vertical-align: -0.278em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21895">C_0= IV</script></li>
<li>用于对大量数据的加密和认证</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="w60d" id="21-缺点">2.1 缺点</h4>

<p data-anchor-id="wuuh">如果攻击者获得了IV，可以通过预先改变IV中的某些位，使得接收者的明文中部分位被取反。</p>

<ul data-anchor-id="5zl1">
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21896-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322797" style="width: 14.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322798"><span class="msubsup" id="MathJax-Span-322799"><span style="display: inline-block; position: relative; width: 1.12em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322800" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mn" id="MathJax-Span-322801" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322802" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-322803" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322804" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-322805" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322806" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-322807" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span class="mo" id="MathJax-Span-322808" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-322809" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322810" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-322811" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322812" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322813" style="font-family: MathJax_Math; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.817em;"><span class="mi" id="MathJax-Span-322814" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322815" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322816"><span style="display: inline-block; position: relative; width: 1.184em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322817" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mn" id="MathJax-Span-322818" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322819" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-322820" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322821" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-322822" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21896">P_1[i] = IV[i] ⊕ D_k(C_1[i])</script></li>
<li><strong>解决方法：在发送消息前用ECB来保护IV</strong></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="iu3z" id="3-密码反馈模式-cipher-feedback-cfb">3. 密码反馈模式 Cipher FeedBack (CFB)</h3>

<p data-anchor-id="jkiu">消息被当做比特流，可以用于实现流密码。实现每次对任意比特的加密。</p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="xnwk" id="31-加密解密">3.1 加密、解密</h4>

<p data-anchor-id="d2hs">明文消息与分组加密的输出进行异或，所得结果反馈进入移位寄存器作为下一阶段的输入。 <br>
加密： <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21897-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322823" style="width: 16.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322824"><span class="msubsup" id="MathJax-Span-322825"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322826" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322827" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322828" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322829" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322830" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322831" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322832" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322833" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.496em 1000em 2.5em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322834" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322835" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322836" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322837"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322838" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-322839" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322840" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322841"><span style="display: inline-block; position: relative; width: 1.053em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.381em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322842" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.641em;"><span class="mi" id="MathJax-Span-322843" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322844" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322845"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322846" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="texatom" id="MathJax-Span-322847"><span class="mrow" id="MathJax-Span-322848"><span class="mi" id="MathJax-Span-322849" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322850" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322851" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322852" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322853" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322854" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21897">C_i= P_i ⊕ A_s(E_K(S_s(C_{i-1})))</script></p>

<ul data-anchor-id="glb8">
<li>其中s是流密码每次加密的长度=<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21898-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322855" style="width: 5.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.423em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.749em -0.314em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322856"><span class="texatom" id="MathJax-Span-322857"><span class="mrow" id="MathJax-Span-322858"><span class="mo" id="MathJax-Span-322859" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-322860"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322861" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322862" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="texatom" id="MathJax-Span-322863"><span class="mrow" id="MathJax-Span-322864"><span class="mo" id="MathJax-Span-322865" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-322866" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-322867" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-322868"><span class="mo" id="MathJax-Span-322869" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-322870"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322871" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322872" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="texatom" id="MathJax-Span-322873"><span class="mrow" id="MathJax-Span-322874"><span class="mo" id="MathJax-Span-322875" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.424em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21898">|P_i| = |C_i|</script>，</li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21899-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322876" style="width: 5.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.279em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.65em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322877"><span class="msubsup" id="MathJax-Span-322878"><span style="display: inline-block; position: relative; width: 1.761em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322879" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="texatom" id="MathJax-Span-322880"><span class="mrow" id="MathJax-Span-322881"><span class="mo" id="MathJax-Span-322882" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322883" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322884" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322885" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-322886" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.236em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21899">C_{-1}= IV</script>,</li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21900-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322887" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.657em -0.381em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322888"><span class="msubsup" id="MathJax-Span-322889"><span style="display: inline-block; position: relative; width: 1.053em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.381em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322890" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.641em;"><span class="mi" id="MathJax-Span-322891" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.246em; vertical-align: -0.267em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21900">S_s</script>代表移位寄存器S移动s位，</li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21901-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322892" style="width: 1.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.657em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322893"><span class="msubsup" id="MathJax-Span-322894"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.496em 1000em 2.5em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322895" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322896" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.26em; vertical-align: -0.267em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21901">A_s</script>代表取前s位</li>
</ul>

<p data-anchor-id="8zvq">解密： <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21902-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322897" style="width: 16.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322898"><span class="msubsup" id="MathJax-Span-322899"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322900" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322901" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322902" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322903" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322904" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322905" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322906" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322907" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.496em 1000em 2.5em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322908" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322909" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322910" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322911"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322912" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-322913" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322914" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322915"><span style="display: inline-block; position: relative; width: 1.053em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.381em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322916" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.641em;"><span class="mi" id="MathJax-Span-322917" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322918" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322919"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322920" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="texatom" id="MathJax-Span-322921"><span class="mrow" id="MathJax-Span-322922"><span class="mi" id="MathJax-Span-322923" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322924" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322925" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322926" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322927" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322928" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21902">P_i=C_i ⊕ A_s(E_K(S_s(C_{i-1})))</script></p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="dl7f" id="32-缺点">3.2 缺点</h4>

<ul data-anchor-id="9ee6">
<li>每得到s个输入比特，需要暂停进行分组加密</li>
<li>存在误差扩散：密文传输中某位发生错误，会影响后继的解密</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="7z9o" id="4-输出反馈模式-output-feedback-ofb">4. 输出反馈模式 Output FeedBack （OFB）</h3>

<ul data-anchor-id="y44a">
<li>与CFB不同，加密函数的输出被反馈回移位寄存器作为下一次的输入（而不是密文单元）。</li>
<li>因为反馈值与明文消息无关，所以反馈值都可以预先计算</li>
<li>分组加密的输出与明文异或得到密文</li>
<li>用于有信道噪声环境下的流密码</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="d0nm" id="41-加密">4.1 加密</h4>

<ul data-anchor-id="sqwf">
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21903-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322929" style="width: 7.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.529em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.658em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322930"><span class="msubsup" id="MathJax-Span-322931"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322932" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322933" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322934" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322935" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322936" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322937" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322938" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322939" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322940" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322941" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.247em; vertical-align: -0.268em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21903">C_i= P_i ⊕ O_i</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21904-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322942" style="width: 13.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.433em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322943"><span class="msubsup" id="MathJax-Span-322944"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322945" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322946" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322947" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322948" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.496em 1000em 2.5em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322949" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322950" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322951" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322952"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322953" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-322954" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322955" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322956"><span style="display: inline-block; position: relative; width: 1.053em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.381em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322957" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.641em;"><span class="mi" id="MathJax-Span-322958" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322959" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322960"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322961" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="texatom" id="MathJax-Span-322962"><span class="mrow" id="MathJax-Span-322963"><span class="mi" id="MathJax-Span-322964" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-322965" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322966" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322967" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322968" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322969" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21904">O_i=A_s(E_K(S_s(O_{i-1})))</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21905-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322970" style="width: 5.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.327em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.508em 1000em 2.65em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322971"><span class="msubsup" id="MathJax-Span-322972"><span style="display: inline-block; position: relative; width: 1.806em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322973" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="texatom" id="MathJax-Span-322974"><span class="mrow" id="MathJax-Span-322975"><span class="mo" id="MathJax-Span-322976" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-322977" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322978" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-322979" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-322980" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.235em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21905">O_{-1}= IV</script></li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="n6ux" id="42-优点">4.2 优点</h4>

<ul data-anchor-id="vr23">
<li>传输过程中，比特差错不会扩散</li>
<li>可以预计算分组，流加密时不需停顿</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="1z6g" id="43-缺点">4.3 缺点</h4>

<ul data-anchor-id="snfl">
<li>对抗消息流篡改攻击的能力弱于CFB：若对密文取反，则解密后的明文也取反</li>
<li>可以看作是一次一密的变形（Vernam密码）所以绝对不能重复使用相同的密钥序列和IV</li>
<li>发送方和接收方必须同步</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="i5hr" id="5-计数器模式-countercrt">5. 计数器模式 Counter（CRT）</h3>

<ul data-anchor-id="yx8w">
<li>明文与分组的输出异或得到密文。</li>
<li>与OFB的差异：分组加密的输入是计数</li>
<li>加密： <br>
<ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21906-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322981" style="width: 7.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.529em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.658em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322982"><span class="msubsup" id="MathJax-Span-322983"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.507em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322984" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.724em;"><span class="mi" id="MathJax-Span-322985" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322986" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-322987" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322988" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.66em;"><span class="mi" id="MathJax-Span-322989" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322990" style="font-family: MathJax_Main; padding-left: 0.222em;">⊕</span><span class="msubsup" id="MathJax-Span-322991" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322992" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322993" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.247em; vertical-align: -0.268em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21906">C_i= P_i ⊕ O_i</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21907-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-322994" style="width: 10.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.365em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-322995"><span class="msubsup" id="MathJax-Span-322996"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(1.508em 1000em 2.522em -0.383em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-322997" style="font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-322998" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-322999" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323000" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323001" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-323002" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323003" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323004" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-323005" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323006" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-323007" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-323008" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-323009" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-323010" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-323011" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21907">O_i = E_K(Counter)</script></li></ul></li>
<li>用途：高速网络加密</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="egg0" id="51-优点">5.1 优点</h4>

<ul data-anchor-id="8vp2">
<li>可以并行处理多块明文密文</li>
<li>可以预计算</li>
<li>good for bursty high speed links</li>
<li>随机访问：密文的第i个分组可以随机访问，不需知道前面i-1个密文组（比较： CBC）</li>
<li>可证安全：是CPA安全的 <br>
<ul><li>前提：使用了真正的随机数生成器，且每个计数器值绝不重用</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="xibh" id="52-缺点">5.2 缺点</h4>

<p data-anchor-id="dajj"><strong>密钥、计数器值绝不能重用！</strong></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="okfc" id="6-随机数">6. 随机数</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="1g3p" id="61-检验随机程度的两个准则">6.1 检验随机程度的两个准则</h4>

<ul data-anchor-id="e6cv">
<li>均匀分布：出现概率大致相等</li>
<li>独立性</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="7i9k" id="62-随机性测试">6.2 随机性测试</h4>

<div class="md-section-divider"></div>

<h5 data-anchor-id="yk9l" id="621-测试特征">6.2.1 测试特征</h5>

<ul data-anchor-id="ka52">
<li>均匀性： 0或1出现的概率和量大致相等</li>
<li>可伸缩性：测试可以用于子序列</li>
<li>一致性：测试针对所有的初始值</li>
</ul>

<div class="md-section-divider"></div>

<h5 data-anchor-id="zxhs" id="622-不可预测程度">6.2.2 不可预测程度</h5>

<ul data-anchor-id="3z9c">
<li>前向不可预测性：不知道种子，无法依据已有bit预测下一bit</li>
<li>后向不可预测性：从序列无法推出种子值</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="jee8" id="63-伪随机数产生器-c-中的rand">6.3 伪随机数产生器 (C++ 中的rand)</h4>

<div class="md-section-divider"></div>

<h5 data-anchor-id="8o46" id="631-线性同余法">6.3.1 线性同余法</h5>

<p data-anchor-id="lolr"><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21908-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323012" style="width: 14.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.058em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.407em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323013"><span class="msubsup" id="MathJax-Span-323014"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323015" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.841em;"><span class="texatom" id="MathJax-Span-323016"><span class="mrow" id="MathJax-Span-323017"><span class="mi" id="MathJax-Span-323018" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-323019" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-323020" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323021" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-323022" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-323023" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-323024"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323025" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.841em;"><span class="mi" id="MathJax-Span-323026" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323027" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-323028" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mo" id="MathJax-Span-323029" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-323030" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323031" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323032" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323033" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323034" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323035" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21908">X_{n+1} = ( aX_n + c )\ mod\  m</script></p>

<pre data-anchor-id="ejmb" class="code-black"><code class="code-black">• m 模数 m&gt;0
• a 乘数 0 ≤ a&lt;m
• c 增量 0≤c&lt;m
• X0 初始值 0&lt;=X0&lt;m
</code></pre>

<div class="md-section-divider"></div>

<h6 data-anchor-id="phce" id="6311-攻击方法">6.3.1.1 攻击方法</h6>

<ul data-anchor-id="567m">
<li>若知道a,c,m，则由一个随机数可以知道后继随机数</li>
<li>即使只知道使用该算法，且知道了四个连续随机数，形成三个线性同余式，就可恢复a,c,m</li>
<li>结论：一旦知道序列的一小部分，不可预测程度就变得很差</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="6wi5" id="64-bbs产生器-blum整数">6.4 BBS产生器 (Blum整数)</h4>

<ul data-anchor-id="vbu8">
<li>选择两个大素数，满足 p≡q≡3 (mod4)</li>
<li>n=p*q,选择s与n互素 <br>
<ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21909-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323036" style="width: 8.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.49em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.666em -0.407em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323037"><span class="msubsup" id="MathJax-Span-323038"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323039" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.841em;"><span class="mn" id="MathJax-Span-323040" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323041" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323042" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.51em -0.38em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323043" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.481em;"><span class="mn" id="MathJax-Span-323044" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mtext" id="MathJax-Span-323045" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323046" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323047" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323048" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323049" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323050" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.424em; vertical-align: -0.278em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21909">X_0 = s^2\  mod \  n</script>;</li></ul></li>
<li>输出： <br>
<ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21910-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323051" style="width: 10.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.317em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.331em 1000em 2.755em -0.407em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323052"><span class="msubsup" id="MathJax-Span-323053"><span style="display: inline-block; position: relative; width: 1.157em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323054" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.841em;"><span class="mi" id="MathJax-Span-323055" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323056" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-323057" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-323058"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323059" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.5em -0.397em); top: -2.766em; left: 0.923em;"><span class="mn" id="MathJax-Span-323060" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.508em -0.418em); top: -2.109em; left: 0.841em;"><span class="texatom" id="MathJax-Span-323061"><span class="mrow" id="MathJax-Span-323062"><span class="mi" id="MathJax-Span-323063" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-323064" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-323065" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mtext" id="MathJax-Span-323066" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323067" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323068" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323069" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323070" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323071" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-323072" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.602em; vertical-align: -0.394em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21910">X_i = (X_{i-1}^2\ mod\ n)</script></li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21911-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323073" style="width: 8.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.518em 1000em 2.658em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323074"><span class="msubsup" id="MathJax-Span-323075"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323076" style="font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.769em;"><span class="mi" id="MathJax-Span-323077" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323078" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323079" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.157em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.407em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323080" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.841em;"><span class="mi" id="MathJax-Span-323081" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mtext" id="MathJax-Span-323082" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323083" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323084" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323085" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323086" style="font-family: MathJax_Main;">&nbsp;</span><span class="mn" id="MathJax-Span-323087" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.232em; vertical-align: -0.268em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21911">B_i = X_i\  mod \ 2 </script></li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h5 data-anchor-id="phm2" id="641-优点缺点">6.4.1 优点、缺点</h5>

<p data-anchor-id="5zw8">优点：随机性、不可预测性 <br>
缺点： 很慢</p>

<div class="md-section-divider"></div>

<h1 data-anchor-id="alef" id="lec6-保密通信技术">Lec6 保密通信技术</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="4l7w" id="1保密通信">1.保密通信</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="0zz3" id="11-简介">1.1 简介</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="2zcr" id="111-攻击和媒介">1.1.1 攻击和媒介</h4>

<ul data-anchor-id="e59f">
<li>攻击 <br>
<ul><li>局域网内监听</li>
<li>搭线窃听</li></ul></li>
<li>传输媒介 <br>
<ul><li>线缆</li>
<li>微波链路</li>
<li>卫星信道</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="ny43" id="12-加密">1.2 加密</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="30u6" id="121-链路加密">1.2.1 链路加密</h4>

<p data-anchor-id="8flv">在通信链路两端加上加密设备，链路上信息传输安全，一条链路上可能有多个用户，中间节点报文为明文（路由器读取IP头，TCP头）。</p>

<ul data-anchor-id="ql2o">
<li>所有潜在通信链路两端都装备加密设备(-)</li>
<li>要求许多加密设备(-)</li>
<li>共享链路的每对节点都共享唯一密钥，密钥数量很大(-)</li>
<li>每次分组交换都需要解密消息，报文在传输中多次加解密(-)</li>
<li>报文在每个交换机处以明文形式存在，易受攻击(-)</li>
<li>用户对报文的安全无法控制(-)</li>
<li>能够鉴别主机(+)</li>
<li>通讯模式是安全的(+)</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="b7ob" id="122-端到端加密">1.2.2 端到端加密</h4>

<p data-anchor-id="jt1q">在两端系统中进行，由源主机或终端加密数据，密文通过网络传给目的主机或者终端。目的主机与源主机共享一个密钥。用户与用户之间共享秘钥，中间节点报文为密文。</p>

<ul data-anchor-id="6xwc">
<li>一般是加密数据，而非信息头，以实现包的路由。用 <br>
户数据安全，传输过程不安全。</li>
<li>加密过程由两个端系统完成(+)</li>
<li>报文在传输中只进行一次加解密(+)</li>
<li>报文在交换机处仍然是安全的?(+)</li>
<li>不能隐蔽通信量(-)</li>
<li>能够鉴别用户(+)</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="gxn5" id="123-应用">1.2.3 应用</h4>

<ul data-anchor-id="etl3">
<li>主机用端对端加密密钥来加密用户数据</li>
<li>整个分组使用链路加密</li>
<li>分组在网络中传输时，各个节点用链路加密密钥来解密信息头。然后再加密，发送到下一条链路</li>
<li>仅在分组交换节点的存储器内可以看到信息 <br>
头的明文</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="xy1q" id="124-加密位置">1.2.4 加密位置</h4>

<ul data-anchor-id="qq9y">
<li>链路加密: OSI的物理层或者链路层</li>
<li>端到端加密： <br>
<ul><li>网络层或传输层（在网关需要断开TCP进行解密，在缓冲区内是明文）</li>
<li>表示层或应用层（只需加密报文） <br>
• 两个不同体系结构的网络之间 <br>
• 相同体系结构但相互隔离的网络之间</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="dtbl" id="2-传输保密性和流量分析">2. 传输保密性和流量分析</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="owlv" id="21-可以得到的信息">2.1 可以得到的信息</h3>

<ul data-anchor-id="vprz">
<li>通信双方的身份</li>
<li>通信双方通信的频率</li>
<li>报文模式、报文长度、报文数量</li>
<li>特定的通信之间交谈所关联的事件</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="xcxc" id="22-防范手段">2.2 防范手段</h3>

<ul data-anchor-id="cco1">
<li>链路加密方式 <br>
<ul><li>分组首部加密， 但仍可以看到网络中的总通信量</li>
<li>通信量填充 （浪费带宽）</li></ul></li>
<li>端到端加密方式 <br>
<ul><li>有很大限制 <br>
-应用层：攻击者可以判断出通信双方 <br>
-传输层：攻击者可以得到网络层的地址和传输格式</li>
<li>填充数据单元</li>
<li>发送空白报文（浪费带宽）</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="0wtk" id="3-对称加密中的密钥分配及管理">3. 对称加密中的密钥分配及管理</h2>

<p data-anchor-id="byzg">广泛应用的是方法：层次式密钥</p>

<ul data-anchor-id="712e">
<li>有一个密钥分配中心KDC负责密钥分发（主机、进程、用户）</li>
<li>每个用户与KDC共享一个密钥（master key），用于密钥分配</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="i8zc" id="31-密钥分级">3.1 密钥分级</h3>

<p data-anchor-id="hohj">典型的应用中，密钥分为主密钥和会话密钥两级，N台主机需要N个主密钥，会话密钥通过主密钥加密后传给用户。</p>

<ul data-anchor-id="3dcf">
<li>会话密钥：用于数据加密，临时</li>
<li>主密钥：由KDC和用户共享，长期</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="33by" id="32-密钥分配协议">3.2 密钥分配协议</h3>

<ul data-anchor-id="4lad">
<li>对KDC进行实体认证</li>
<li>对B进行实体认证</li>
<li>对消息进行认证（临时交互号，防止重放攻击）</li>
<li>AB通信中对A进行实体认证</li>
<li>AB通信中对消息进行认证</li>
</ul>

<p data-anchor-id="4rq6"><img src="http://i57.tinypic.com/29q1ldg.jpg" alt="密钥分配协议" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="ij62" id="33-层次式密钥分配">3.3 层次式密钥分配</h3>

<ul data-anchor-id="ii75">
<li>建立一系列KDC，各个KDC之间存在层次关系</li>
<li>最低层的负责某一区域</li>
<li>不同区域之间的通信通过上一层KDC进行</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="57a8" id="34-会话密钥的生命周期">3.4 会话密钥的生命周期</h3>

<ul data-anchor-id="5xnz">
<li>对于面向连接的协议 <br>
<ul><li>一个连接一个会话密钥</li>
<li>如果连接时间很长，则可以选择协议数据单元PDU序号循环周期作为会话密钥的寿命长度</li></ul></li>
<li>对于无连接的协议 <br>
<ul><li>最好一个交互过程一个会话密钥</li>
<li>固定时间段或者一定数量的交互量后更换一次会话密钥</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="b0iw" id="35-密钥的使用方式">3.5 密钥的使用方式</h3>

<ul data-anchor-id="krf8">
<li>使用校验码的比特位：灵活性和功能受限</li>
<li><p>控制向量</p>

<pre class="code-black"><code class="code-black">Hash value = H = h(CV)
//Km为主密钥，Ks为会话密钥
Key input = Km ⊕ H
Ciphertext = E([Km ⊕ H], Ks)
</code></pre>

<p>逆操作来恢复会话密钥。</p>

<pre class="code-black"><code class="code-black">Ks = D([Km ⊕ H], Ciphertext)
</code></pre>

<p>CV的长度无限制，可实现对密钥的任意复杂控制 <br>
CV始终是明文形式，可以多次运用对密钥的控制要求</p></li>
</ul>

<div class="md-section-divider"></div>

<h1 data-anchor-id="6nsb" id="lect7-初等数论入门">Lect7 初等数论入门</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="8y0s" id="1-整数和素数">1. 整数和素数</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="eijr" id="11-整数引理">1.1 整数引理</h3>

<p data-anchor-id="pt9g">引理1 ： a|b,则(-a)|b, a|(-b), (-a)|(-b), |a| | |b| <br>
引理2： a|b, b|c, 则a|c <br>
引理3：如果|a|&lt;|b|, |b| | |a|,则a=0 <br>
<strong>引理4： b≠0，则有且 仅有二个整数q,r，可使得a=qb+r， 0≤r＜|b|</strong> <br>
引理5：如果a是大于1的整数，则a的大于1的最小因数一定是素数。换句话说，任何大于1的整数都至少有一个素因数 <br>
引理6：如果a是一个大于1的整数，所有≤ 的素数都除不尽a，则a是素数（提供了一种素数判定方法，是最简单的“筛法” <br>
引理7： 素数个数无限 <br>
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21912-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323088" style="width: 8.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.683em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.104em 1000em 3.208em -0.433em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323089"><span class="mtext" id="MathJax-Span-323090" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-323091" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px;"><span style="position: absolute; clip: rect(1.518em 1000em 2.5em -0.407em); top: -2.356em; left: 0.24em;"><span class="mo" id="MathJax-Span-323092" style="font-family: MathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.85em 1000em 2.608em -0.408em); top: -1.756em; left: 0em;"><span class="texatom" id="MathJax-Span-323093"><span class="mrow" id="MathJax-Span-323094"><span class="mi" id="MathJax-Span-323095" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-323096" style="font-size: 70.7%; font-family: MathJax_Main;">→</span><span class="mi" id="MathJax-Span-323097" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-323098" style="padding-left: 0.287em; padding-right: 0.12em;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(1.681em 1000em 2.677em -0.419em); top: -2.933em; left: 50%; margin-left: -0.745em;"><span class="mrow" id="MathJax-Span-323099"><span class="mi" id="MathJax-Span-323100" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-323101" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323102" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-323103" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.011em; left: 50%; margin-left: -0.216em;"><span class="mi" id="MathJax-Span-323104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000em 1.202em -0.433em); top: -1.278em; left: 0em;"><span style="border-left-width: 1.61em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-323105" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-323106" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-323107" style="font-family: MathJax_Main;">;</span><span class="mtext" id="MathJax-Span-323108" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.485em; vertical-align: -0.983em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21912">\ \lim\limits_{x \rightarrow \infty }  \frac{\pi (x)}{x}=0; \  </script> x越大，素数分布越稀疏。</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="fpv2" id="12-哥德巴赫猜想">1.2 哥德巴赫猜想</h3>

<ul data-anchor-id="73n7">
<li>凡大于4的偶数都是二个奇素数之和 （1+1=2）</li>
<li>华罗庚的贡献：每一个充分大的偶数都是一个素数及一个不超过二个素数的乘积之和</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="nzju" id="13-一次同余式">1.3 一次同余式</h3>

<ul data-anchor-id="p0d6">
<li>a,b都是整数， m为正整数，当a!≡0(mod m)时，ax+b ≡0(mod m)叫做模m的一次同余式.</li>
<li>若c使得上述等式成立，则x ≡ c(mod m)是一次同余式的一个解.</li>
<li>当(a,m)=1时， ax+b ≡0(mod m)一定有整数解.</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="pxsf" id="14-拓展euclid算法">1.4 拓展Euclid算法</h3>

<pre data-anchor-id="cdkw" class="code-black"><code class="code-black">function extended-Euclid(a, b)
Input: Two positive integers a and b with a ≥ b ≥ 0
Output: Integers x, y, d such that d = gcd(a, b) and ax + by = d
if b = 0: return (1, 0, a)
(x`, y`, d) = Extended-Euclid(b, a mod b)
return (y`, x − ⌊a/b⌋y`, d)
</code></pre>

<div class="md-section-divider"></div>

<h3 data-anchor-id="7htu" id="15-整数的唯一因子分解">1.5 整数的唯一因子分解</h3>

<ul data-anchor-id="q12z">
<li>每一个大于1的整数a都可以分解为素数的连乘积.</li>
<li>任意正整数a，都可以唯一的因子分解为 <br>
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21913-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323109" style="width: 9.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.019em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.369em 1000em 2.834em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323110"><span class="mi" id="MathJax-Span-323111" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-323112" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323113" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.373em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.694em -0.472em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323114" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.507em -0.409em); top: -2.707em; left: 0.529em;"><span class="texatom" id="MathJax-Span-323115"><span class="mrow" id="MathJax-Span-323116"><span class="mi" id="MathJax-Span-323117" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mn" id="MathJax-Span-323118" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.5em -0.374em); top: -2.049em; left: 0.529em;"><span class="mn" id="MathJax-Span-323119" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-323120"><span style="display: inline-block; position: relative; width: 1.373em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.694em -0.472em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323121" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.507em -0.409em); top: -2.707em; left: 0.529em;"><span class="texatom" id="MathJax-Span-323122"><span class="mrow" id="MathJax-Span-323123"><span class="mi" id="MathJax-Span-323124" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mn" id="MathJax-Span-323125" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.741em 1000em 2.5em -0.397em); top: -2.049em; left: 0.529em;"><span class="mn" id="MathJax-Span-323126" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323127" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-323128" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-323129" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="msubsup" id="MathJax-Span-323130" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.694em -0.472em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323131" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.721em 1000em 2.508em -0.409em); top: -2.708em; left: 0.529em;"><span class="texatom" id="MathJax-Span-323132"><span class="mrow" id="MathJax-Span-323133"><span class="mi" id="MathJax-Span-323134" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-323135" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.721em 1000em 2.508em -0.406em); top: -2.029em; left: 0.529em;"><span class="mi" id="MathJax-Span-323136" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.655em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21913">a = p_1^{a1}p_2^{a2}...p_l^{al}</script></li>
</ul>

<p data-anchor-id="i93a">引理8：形为pj的整数只能为pi整除，其中i≤j</p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="a70z" id="应用">应用</h4>

<ul data-anchor-id="ptxb">
<li>最大公因数：将a和b表示为质数的乘积，求所有质数的最大公因数的乘积</li>
<li>最小公倍数：求所有质数的最小公倍数的乘积</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="skc8" id="2-剩余系">2. 剩余系</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="qx7g" id="21-整数同余">2.1 整数同余</h3>

<p data-anchor-id="6yqq">a，b为整数， m为固定正整数，则a和b对模m同余是指m|a-b。记为a ≡ b(mod m)。</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="2djo" id="22-完全剩余系">2.2 完全剩余系</h3>

<p data-anchor-id="8vtf">用同余关系可以将整数集合Z分成m个等价类: [0],<a href="http://i58.tinypic.com/2ypfzvq.png" target="_blank">1</a>, …,[m-1]. 这样同余类只有m个,每类都有无穷个元素。</p>

<pre data-anchor-id="1le8" class="code-black"><code class="code-black">    从模n的每个剩余类中各取一个数，得到一个由n个数组成的集合，叫做模n的一个完全剩余系。例如，一个数除以4的余数只能是0，1，2，3，{0，1，2，3}和{4，5，-2，11}是模4的完全剩余系。可以看出0和4，1和5，2和-2，3和11模4同余，这4组数分别属于4个剩余类。
</code></pre>

<div class="md-section-divider"></div>

<h3 data-anchor-id="lo8z" id="23-简化剩余系">2.3 简化剩余系</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="wvzm" id="简化剩余系">简化剩余系:</h4>

<p data-anchor-id="zp46">在模m的完全剩余系中,去掉与m不互素的那些数,剩下的部分称为模m的简化剩余系。 Zm的简化剩余系记为Zm* ,读为模m的非负最小简化剩余系。</p>

<pre data-anchor-id="g21l" class="code-black"><code class="code-black">e.g. Z9*={1,2,4,5,7,8}
</code></pre>

<div class="md-section-divider"></div>

<h4 data-anchor-id="79eo" id="euler函数">Euler函数:</h4>

<ul data-anchor-id="3x1j">
<li>简化剩余系中的元素个数</li>
<li>不超过m并且与m互素的数的个数</li>
<li>记为φ(m),称φ(m)为Euler函数</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="dtpi" id="24-euler定理">2.4 Euler定理</h3>

<p data-anchor-id="qe8g">引理9：<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21914-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323137" style="width: 29.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.356em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.412em 1000em 2.75em -0.433em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323138"><span class="texatom" id="MathJax-Span-323139"><span class="mrow" id="MathJax-Span-323140"><span class="mo" id="MathJax-Span-323141"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">设</span></span></span></span><span class="msubsup" id="MathJax-Span-323142"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323143" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323144" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323145" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323146" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323147" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323148" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="texatom" id="MathJax-Span-323149"><span class="mrow" id="MathJax-Span-323150"><span class="mo" id="MathJax-Span-323151"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">为</span></span></span></span><span class="texatom" id="MathJax-Span-323152"><span class="mrow" id="MathJax-Span-323153"><span class="mo" id="MathJax-Span-323154"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">正</span></span></span></span><span class="texatom" id="MathJax-Span-323155"><span class="mrow" id="MathJax-Span-323156"><span class="mo" id="MathJax-Span-323157"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">整</span></span></span></span><span class="texatom" id="MathJax-Span-323158"><span class="mrow" id="MathJax-Span-323159"><span class="mo" id="MathJax-Span-323160"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">数</span></span></span></span><span class="mo" id="MathJax-Span-323161" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-323162" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-323163"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323164" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323165" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323166" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323167" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323168" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323169" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323170" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323171" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-323172" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-323173" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-323174" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-323175"><span class="mo" id="MathJax-Span-323176"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">若</span></span></span></span><span class="mi" id="MathJax-Span-323177" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-323178" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-323179" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">B</span><span class="texatom" id="MathJax-Span-323180"><span class="mrow" id="MathJax-Span-323181"><span class="mo" id="MathJax-Span-323182"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">分</span></span></span></span><span class="texatom" id="MathJax-Span-323183"><span class="mrow" id="MathJax-Span-323184"><span class="mo" id="MathJax-Span-323185"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">别</span></span></span></span><span class="texatom" id="MathJax-Span-323186"><span class="mrow" id="MathJax-Span-323187"><span class="mo" id="MathJax-Span-323188"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">是</span></span></span></span><span class="texatom" id="MathJax-Span-323189"><span class="mrow" id="MathJax-Span-323190"><span class="mo" id="MathJax-Span-323191"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">模</span></span></span></span><span class="msubsup" id="MathJax-Span-323192"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323193" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323194" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323195" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323196" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323197" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323198" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.49em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21914">设m_1,m_2为正整数, (m_1,m_2) =1,若A,B分别是模m_1,m_2</script>的简化剩余系,<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21915-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323199" style="width: 19.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.24em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.412em 1000em 2.7em -0.433em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323200"><span class="texatom" id="MathJax-Span-323201"><span class="mrow" id="MathJax-Span-323202"><span class="mo" id="MathJax-Span-323203"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">则</span></span></span></span><span class="msubsup" id="MathJax-Span-323204"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323205" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323206" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mi" id="MathJax-Span-323207" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-323208" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-323209" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323210" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323211" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mi" id="MathJax-Span-323212" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-323213"><span class="mrow" id="MathJax-Span-323214"><span class="mo" id="MathJax-Span-323215"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">是</span></span></span></span><span class="texatom" id="MathJax-Span-323216"><span class="mrow" id="MathJax-Span-323217"><span class="mo" id="MathJax-Span-323218"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">模</span></span></span></span><span class="msubsup" id="MathJax-Span-323219"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323220" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323221" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-323222"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323223" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323224" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="texatom" id="MathJax-Span-323225"><span class="mrow" id="MathJax-Span-323226"><span class="mo" id="MathJax-Span-323227"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">的</span></span></span></span><span class="texatom" id="MathJax-Span-323228"><span class="mrow" id="MathJax-Span-323229"><span class="mo" id="MathJax-Span-323230"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">简</span></span></span></span><span class="texatom" id="MathJax-Span-323231"><span class="mrow" id="MathJax-Span-323232"><span class="mo" id="MathJax-Span-323233"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">化</span></span></span></span><span class="texatom" id="MathJax-Span-323234"><span class="mrow" id="MathJax-Span-323235"><span class="mo" id="MathJax-Span-323236"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">剩</span></span></span></span><span class="texatom" id="MathJax-Span-323237"><span class="mrow" id="MathJax-Span-323238"><span class="mo" id="MathJax-Span-323239"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">余</span></span></span></span><span class="texatom" id="MathJax-Span-323240"><span class="mrow" id="MathJax-Span-323241"><span class="mo" id="MathJax-Span-323242"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 77%; font-style: normal; font-weight: normal;">系</span></span></span></span><span class="mo" id="MathJax-Span-323243" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.425em; vertical-align: -0.323em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21915">则m_2A+m_1B是模m_1m_2的简化剩余系.</script></p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="ntrm" id="euler定理">Euler定理：</h4>

<div class="md-section-divider"></div>

<h4 data-anchor-id="lvvu" id="设a-n-1-则-aφn-1mod-na-n-1-则-aφn-1mod-n">设<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21916-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323244" style="width: 15.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.274em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.26em 1000em 2.662em -0.294em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-323245"><span class="mo" id="MathJax-Span-323246" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323247" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-323248" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-323249" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mo" id="MathJax-Span-323250" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323251" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-323252" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-323253" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-323254" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-323255"><span class="mo" id="MathJax-Span-323256"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 78%; font-style: normal; font-weight: normal;">则</span></span></span></span><span class="msubsup" id="MathJax-Span-323257"><span style="display: inline-block; position: relative; width: 1.97em; height: 0px;"><span style="position: absolute; clip: rect(1.712em 1000em 2.422em -0.355em); top: -2.283em; left: 0em;"><span class="mi" id="MathJax-Span-323258" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.283em;"></span></span><span style="position: absolute; top: -2.645em; left: 0.517em;"><span class="texatom" id="MathJax-Span-323259"><span class="mrow" id="MathJax-Span-323260"><span class="texatom" id="MathJax-Span-323261"><span class="mrow" id="MathJax-Span-323262"><span class="mo" id="MathJax-Span-323263" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">φ</span></span></span><span class="mo" id="MathJax-Span-323264" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323265" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-323266" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.283em;"></span></span></span></span><span class="mo" id="MathJax-Span-323267" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="mn" id="MathJax-Span-323268" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-323269" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323270" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323271" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323272" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-323273" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-323274" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.283em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.586em; vertical-align: -0.378em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21916">(a, n) = 1 , 则 a^{φ(n)} ≡ 1(mod n)</script></h4>

<pre data-anchor-id="jh6e" class="code-black"><code class="code-black">e.g. a = 3; n = 10; φ(10) = 4;
3^4 = 81 = 1 mod 10
</code></pre>

<div class="md-section-divider"></div>

<h3 data-anchor-id="0wfa" id="title"><strong>!!!</strong></h3>

<p data-anchor-id="h0ga">当n=pq， pq为素数时，有 <br>
   <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21917-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323275" style="width: 22.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.212em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.318em 1000em 2.749em -0.401em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323276"><span class="texatom" id="MathJax-Span-323277"><span class="mrow" id="MathJax-Span-323278"><span class="msubsup" id="MathJax-Span-323279"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px;"><span style="position: absolute; clip: rect(1.759em 1000em 2.506em -0.401em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323280" style="font-family: MathJax_Main; font-weight: bold;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.577em;"><span class="texatom" id="MathJax-Span-323281"><span class="mrow" id="MathJax-Span-323282"><span class="texatom" id="MathJax-Span-323283"><span class="mrow" id="MathJax-Span-323284"><span class="mo" id="MathJax-Span-323285" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic; font-weight: bold;">φ</span></span></span><span class="mo" id="MathJax-Span-323286" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">(</span><span class="mi" id="MathJax-Span-323287" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">p</span><span class="mi" id="MathJax-Span-323288" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-323289" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">)</span><span class="mo" id="MathJax-Span-323290" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">+</span><span class="mn" id="MathJax-Span-323291" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323292" style="font-family: MathJax_Main; font-weight: bold; padding-left: 0.278em;">≡</span><span class="msubsup" id="MathJax-Span-323293" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 6.085em; height: 0px;"><span style="position: absolute; clip: rect(1.759em 1000em 2.506em -0.401em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323294" style="font-family: MathJax_Main; font-weight: bold;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.577em;"><span class="texatom" id="MathJax-Span-323295"><span class="mrow" id="MathJax-Span-323296"><span class="mo" id="MathJax-Span-323297" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">(</span><span class="mi" id="MathJax-Span-323298" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">p</span><span class="mo" id="MathJax-Span-323299" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">−</span><span class="mn" id="MathJax-Span-323300" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span><span class="mo" id="MathJax-Span-323301" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">)</span><span class="mo" id="MathJax-Span-323302" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">(</span><span class="mi" id="MathJax-Span-323303" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-323304" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">−</span><span class="mn" id="MathJax-Span-323305" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span><span class="mo" id="MathJax-Span-323306" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">)</span><span class="mo" id="MathJax-Span-323307" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">+</span><span class="mn" id="MathJax-Span-323308" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323309" style="font-family: MathJax_Main; font-weight: bold; padding-left: 0.278em;">≡</span><span class="mi" id="MathJax-Span-323310" style="font-family: MathJax_Main; font-weight: bold; padding-left: 0.278em;">a</span><span class="mo" id="MathJax-Span-323311" style="font-family: MathJax_Main; font-weight: bold;">(</span><span class="mi" id="MathJax-Span-323312" style="font-family: MathJax_Main; font-weight: bold;">m</span><span class="mi" id="MathJax-Span-323313" style="font-family: MathJax_Main; font-weight: bold;">o</span><span class="mi" id="MathJax-Span-323314" style="font-family: MathJax_Main; font-weight: bold;">d</span><span class="mtext" id="MathJax-Span-323315" style="font-family: MathJax_Main; font-weight: bold;">&nbsp;</span><span class="mi" id="MathJax-Span-323316" style="font-family: MathJax_Main; font-weight: bold;">n</span><span class="mo" id="MathJax-Span-323317" style="font-family: MathJax_Main; font-weight: bold;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.61em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21917">\mathbf{a^{φ(pq)+1}  ≡  a^{(p-1)(q-1)+1} ≡ a (mod \ n)}</script> <br>
   即使(n,a) ≠1 ，等式仍成立</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="rsr9" id="title-1"><strong>!!!</strong></h3>

<div class="md-section-divider"></div>

<h3 data-anchor-id="5qsw" id="25-euler函数的计算">2.5 Euler函数的计算</h3>

<ul data-anchor-id="t4dp">
<li>φ(1)=1</li>
<li>φ(p)=p-1,p为素数</li>
<li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21918-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323318" style="width: 7.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.358em 1000em 2.75em -0.383em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323319"><span class="texatom" id="MathJax-Span-323320"><span class="mrow" id="MathJax-Span-323321"><span class="texatom" id="MathJax-Span-323322"><span class="mrow" id="MathJax-Span-323323"><span class="mo" id="MathJax-Span-323324" style="font-family: MathJax_Math; font-style: italic;">φ</span></span></span></span></span><span class="mo" id="MathJax-Span-323325" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-323326"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.694em -0.413em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323327" style="font-family: MathJax_Main;">p</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.577em;"><span class="mi" id="MathJax-Span-323328" style="font-size: 70.7%; font-family: MathJax_Main;">k</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323329" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323330" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323331" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.694em -0.413em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323332" style="font-family: MathJax_Main;">p</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.577em;"><span class="texatom" id="MathJax-Span-323333"><span class="mrow" id="MathJax-Span-323334"><span class="mi" id="MathJax-Span-323335" style="font-size: 70.7%; font-family: MathJax_Main;">k</span><span class="mo" id="MathJax-Span-323336" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-323337" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.56em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21918">\rm {φ}(p^k)=p^{k-1}</script> (p-1)， p为素数 <br>
(小于等于p的k次方的与p不互素的数每p个数中就有1个)</li>
<li>引理10： φ(m1·m2)= φ(m1) φ(m2)，前提是(m1, m2) =1</li>
</ul>

<p data-anchor-id="3q2k"><img src="http://i60.tinypic.com/2d11blw.jpg" alt="Euler函数" title=""></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="s1yw" id="3-fermat小定理和euler定理">3. Fermat小定理和Euler定理</h2>

<p data-anchor-id="bf12">p是素数， a为正整数， p 不能整除 a，则有 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21919-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323338" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.971em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323339"><span class="msubsup" id="MathJax-Span-323340"><span style="display: inline-block; position: relative; width: 1.95em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323341" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="texatom" id="MathJax-Span-323342"><span class="mrow" id="MathJax-Span-323343"><span class="mi" id="MathJax-Span-323344" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-323345" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-323346" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.222em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21919">a^{p-1}</script> ≡ 1(mod p)</p>

<p data-anchor-id="a3z7">引理11： <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21920-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323347" style="width: 14.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.318em 1000em 2.75em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323348"><span class="msubsup" id="MathJax-Span-323349"><span style="display: inline-block; position: relative; width: 2.912em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323350" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="texatom" id="MathJax-Span-323351"><span class="mrow" id="MathJax-Span-323352"><span class="mi" id="MathJax-Span-323353" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-323354" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323355" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-323356" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-323357" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-323358" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323359" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="mn" id="MathJax-Span-323360" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-323361" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323362" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323363" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323364" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323365" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-323366" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-323367" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323368" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-323369" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">k</span><span class="mo" id="MathJax-Span-323370" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mn" id="MathJax-Span-323371" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.611em; vertical-align: -0.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21920">a^{k(p-1)} ≡1(mod \ p), k≥1</script></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="i3g5" id="4-素性检测">4. 素性检测</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="xkmn" id="miller-rabin概率算法">Miller-Rabin概率算法</h3>

<ul data-anchor-id="rddz">
<li>产生的结果几乎肯定是素数</li>
<li>可以简单理解为 ：返回的否定结论一定是正确的，返回的肯定结论的出错概率很低。因此执行多次后，若均返回肯定结论，则出错的概率会大大降低</li>
</ul>

<p data-anchor-id="zaw5"><img src="http://i60.tinypic.com/19tt0n.png" alt="素性检测" title=""></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="gk9b" id="5-中国剩余定理">5. 中国剩余定理</h2>

<p data-anchor-id="v5yn">设(m1, m2,…,mk) 是k个两两互素的整数，则线性同余式组 <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21921-Frame"><nobr><span class="math" id="MathJax-Span-323372" style="width: 11.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.462em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(2.196em 1000em 6.535em -0.263em); top: -4.615em; left: 0em;"><span class="mrow" id="MathJax-Span-323373"><span class="mrow" id="MathJax-Span-323374"><span class="mo" id="MathJax-Span-323375" style="vertical-align: 2.275em;"><span style="display: inline-block; position: relative; width: 0.889em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.091em; left: 0em;">⎧<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.839em; left: 0em;">⎩<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -1.715em; left: 0em;">⎨<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.828em; left: 0em;">⎪<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.802em; left: 0em;">⎪<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtable" id="MathJax-Span-323376" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 7.249em; height: 0px;"><span style="position: absolute; clip: rect(2.41em 1000em 6.151em -0.398em); top: -4.471em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -3.831em; right: 0em;"><span class="mtd" id="MathJax-Span-323377"><span class="mrow" id="MathJax-Span-323378"><span class="mi" id="MathJax-Span-323379" style="font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.331em; right: 0em;"><span class="mtd" id="MathJax-Span-323396"><span class="mrow" id="MathJax-Span-323397"><span class="mi" id="MathJax-Span-323398" style="font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -0.831em; right: 0em;"><span class="mtd" id="MathJax-Span-323415"><span class="mrow" id="MathJax-Span-323416"><span class="mi" id="MathJax-Span-323417" style="font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.471em;"></span></span><span style="position: absolute; clip: rect(2.631em 1000em 6.919em -0.377em); top: -5em; left: 0.855em;"><span style="display: inline-block; position: relative; width: 6.394em; height: 0px;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.377em); top: -3.831em; left: 0em;"><span class="mtd" id="MathJax-Span-323380"><span class="mrow" id="MathJax-Span-323381"><span class="mo" id="MathJax-Span-323382" style="font-family: MathJax_Main;">=</span><span class="mtext" id="MathJax-Span-323383" style="font-family: MathJax_Main; padding-left: 0.278em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323384"><span style="display: inline-block; position: relative; width: 0.892em; height: 0px;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.393em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323385" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.433em;"><span class="mn" id="MathJax-Span-323386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323387" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323388" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323389" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323390" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323391" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323392"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323393" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323394" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323395" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.377em); top: -2.331em; left: 0em;"><span class="mtd" id="MathJax-Span-323399"><span class="mrow" id="MathJax-Span-323400"><span class="mo" id="MathJax-Span-323401" style="font-family: MathJax_Main;">=</span><span class="mtext" id="MathJax-Span-323402" style="font-family: MathJax_Main; padding-left: 0.278em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323403"><span style="display: inline-block; position: relative; width: 0.892em; height: 0px;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.393em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323404" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.433em;"><span class="mn" id="MathJax-Span-323405" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323406" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323407" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323408" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323409" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323410" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323411"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323412" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mn" id="MathJax-Span-323413" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323414" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.377em); top: -0.831em; left: 0em;"><span class="mtd" id="MathJax-Span-323418"><span class="mrow" id="MathJax-Span-323419"><span class="mo" id="MathJax-Span-323420" style="font-family: MathJax_Main;">=</span><span class="mtext" id="MathJax-Span-323421" style="font-family: MathJax_Main; padding-left: 0.278em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323422"><span style="display: inline-block; position: relative; width: 0.892em; height: 0px;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.393em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323423" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.433em;"><span class="mi" id="MathJax-Span-323424" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323425" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323426" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-323427" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-323428" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-323429" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-323430"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323431" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.865em;"><span class="mi" id="MathJax-Span-323432" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323433" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.615em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.39em; vertical-align: -2.37em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-21921"> \left\{
\begin{aligned}
x & =  \ b_1(mod \ m_1) \\
x & =  \ b_2(mod \ m_2) \\
x & =  \ b_k(mod \ m_k)
\end{aligned}
\right.
</script> <br>
对于模m1 ·m2 ·… · mk有惟一解。</p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="l4nc" id="6-次数和原根">6. 次数和原根</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="4dqd" id="次数">次数</h3>

<p data-anchor-id="9egg">由Euler定理， (a, m)=1,有a^Φ(m) ≡1(mod m),所以a^0， a^1，a^2，。。。序列一定出现周期性循环</p>

<ul data-anchor-id="sn7w">
<li>将使得上述序列出现重复的最小正整数k称为a模m的次数。</li>
<li>一定有k | Φ(m)，但k= Φ(m)不一定成立 ( k &lt;= Φ(m))</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="faf9" id="原根">原根</h3>

<ul data-anchor-id="dvkf">
<li>如果a模m的次数为Φ(m)，则称a是模m的一个原根</li>
<li>并非所有m都有原根</li>
<li>m有原根的充要条件是m形如2, 4, 2npl, pl (其证明过程也给出了原根的构造方法，略）</li>
<li>原根个数为Φ(Φ(m))个</li>
<li>原根可以生成模m的简化剩余系</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="k05i" id="7-离散对数问题">7. 离散对数问题</h2>

<p data-anchor-id="2c0j">指数运算y ≡ <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21922-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323434" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.536em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323435"><span class="msubsup" id="MathJax-Span-323436"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323437" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.58em;"><span class="mi" id="MathJax-Span-323438" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21922">g^x</script>（mod m）的逆问题是计算一个数模m的离散对数 <br>
- 记为x = <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21923-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323439" style="width: 2.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.26em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.518em 1000em 2.885em -0.395em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323440"><span class="mi" id="MathJax-Span-323441" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-323442" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="msubsup" id="MathJax-Span-323443"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323444" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.526em;"><span class="mi" id="MathJax-Span-323445" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mi" id="MathJax-Span-323446" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.563em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21923">log_gy</script> (mod m) <br>
如果g是原根，则上式一定有整数解。如果g不是原根，可能无解。 <br>
<strong>由x， g， m计算y很容易； 但由y， g， m计算x一般非常困难。</strong></p>

<div class="md-section-divider"></div>

<h1 data-anchor-id="hvzr" id="lec8-公钥系统定义及rsa">Lec8 公钥系统定义及RSA</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="7mxu" id="1公钥密码">1.公钥密码</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="me1d" id="11-公钥密码原理">1.1 公钥密码原理</h3>

<ul data-anchor-id="xi4u">
<li>每个用户拥有一对公私钥对(PK , SK) <br>
<ul><li>公钥PK公开，私钥SK保密；</li>
<li>已知公钥算法，公钥PK，得不到SK的值。</li></ul></li>
<li>用于加解密 <br>
<ul><li>加密C=<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21924-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323447" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.827em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.532em 1000em 2.756em -0.402em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323448"><span class="msubsup" id="MathJax-Span-323449"><span style="display: inline-block; position: relative; width: 1.804em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323450" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.743em;"><span class="texatom" id="MathJax-Span-323451"><span class="mrow" id="MathJax-Span-323452"><span class="msubsup" id="MathJax-Span-323453"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.409em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323454" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.5em;"><span class="mi" id="MathJax-Span-323455" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.342em; vertical-align: -0.395em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21924">E_{P_K}</script>[M]</li>
<li>解密M=<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21925-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323456" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.529em 1000em 2.76em -0.4em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323457"><span class="msubsup" id="MathJax-Span-323458"><span style="display: inline-block; position: relative; width: 1.836em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323459" style="font-family: MathJax_Math; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.817em;"><span class="texatom" id="MathJax-Span-323460"><span class="mrow" id="MathJax-Span-323461"><span class="msubsup" id="MathJax-Span-323462"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px;"><span style="position: absolute; clip: rect(1.713em 1000em 2.516em -0.396em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323463" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.458em;"><span class="mi" id="MathJax-Span-323464" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.351em; vertical-align: -0.401em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21925">D_{S_K}</script>[C]</li></ul></li>
<li>用于数字签名 <br>
<ul><li>签名M|| <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21926-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323465" style="width: 3.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.548em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.507em 1000em 2.846em -0.381em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323466"><span class="mi" id="MathJax-Span-323467" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mi" id="MathJax-Span-323468" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-323469"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323470" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -3.75em; left: 0.526em;"><span class="texatom" id="MathJax-Span-323471"><span class="mrow" id="MathJax-Span-323472"><span class="msubsup" id="MathJax-Span-323473"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px;"><span style="position: absolute; clip: rect(1.713em 1000em 2.516em -0.396em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323474" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.458em;"><span class="mi" id="MathJax-Span-323475" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.492em; vertical-align: -0.513em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21926">Sig_{S_K}</script>[M]</li>
<li>验证M=<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21927-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323476" style="width: 7.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.846em -0.381em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323477"><span class="mi" id="MathJax-Span-323478" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span class="mi" id="MathJax-Span-323479" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-323480"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323481" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.433em;"><span class="texatom" id="MathJax-Span-323482"><span class="mrow" id="MathJax-Span-323483"><span class="msubsup" id="MathJax-Span-323484"><span style="display: inline-block; position: relative; width: 0.986em; height: 0px;"><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.409em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323485" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.5em;"><span class="mi" id="MathJax-Span-323486" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-323487" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-323488" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mi" id="MathJax-Span-323489" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-323490"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323491" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -3.75em; left: 0.526em;"><span class="texatom" id="MathJax-Span-323492"><span class="mrow" id="MathJax-Span-323493"><span class="msubsup" id="MathJax-Span-323494"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px;"><span style="position: absolute; clip: rect(1.713em 1000em 2.516em -0.396em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323495" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.458em;"><span class="mi" id="MathJax-Span-323496" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.55em; vertical-align: -0.513em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21927">Ver_{P_K}[Sig_{S_K}</script>[M]]</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="22gv" id="12-不对称性是公钥最为重要的性质">1.2 不对称性是公钥最为重要的性质</h3>

<p data-anchor-id="oje6">可以用来保证“真实”性，“不可否认”性</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="vron" id="13-公钥密码系统的要求">1.3 公钥密码系统的要求</h3>

<ul data-anchor-id="qw5b">
<li>每个用户可以方便快捷地产生自己的公私钥对</li>
<li>方便快捷地利用公钥PK对某个消息M进行加密</li>
<li>如果拥有私钥SK可以方便快捷地对某个密文进行解密</li>
<li>已知公钥PK不能得出私钥SK</li>
<li>已知公钥PK和密文C，不能得出明文M</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="jf7d" id="2-单向函数">2. 单向函数</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="exzi" id="21-定义">2.1 定义</h3>

<ul data-anchor-id="6h6m">
<li>给定x，计算y=f (x)是容易的；</li>
<li><p>给定y, 计算x使y=f (x)是困难的。</p>

<pre class="code-black"><code class="code-black">e.g. 离散对数
</code></pre></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="zi5q" id="22-单向陷门函数">2.2 单向陷门函数</h3>

<ul data-anchor-id="6abt">
<li>存在δ：已知δ时对给定的任何y，只要相应的x存在，则计算x使y=f(x)是容易的</li>
<li>δ 称为陷门信息</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="m6cu" id="3-rsa公钥密码">3. RSA公钥密码</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="0ay6" id="31-参数选取">3.1 参数选取</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="jtur" id="rsa密码体制">RSA密码体制</h4>

<ul data-anchor-id="yb6b">
<li>明文空间M＝密文空间C = Zn ={0,1,…, n-1}</li>
<li>分组是<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21928-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323497" style="width: 3.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.404em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.518em 1000em 2.74em -0.395em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323498"><span class="mi" id="MathJax-Span-323499" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-323500" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="msubsup" id="MathJax-Span-323501"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323502" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.526em;"><span class="mn" id="MathJax-Span-323503" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mi" id="MathJax-Span-323504" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.34em; vertical-align: -0.375em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21928">log_2n</script> 比特</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="sj9o" id="密钥的生成">密钥的生成</h4>

<ul data-anchor-id="qu5d">
<li>选择不同的素数p, q，</li>
<li>计算n=pq,  Φ(n)=(p-1)(q-1)</li>
<li>选择整数e 使gcd( Φ(n), e)=1, 其中 1
</li><li>计算d，使d ≡ <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21929-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323505" style="width: 2.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.538em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.511em -0.394em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323506"><span class="msubsup" id="MathJax-Span-323507"><span style="display: inline-block; position: relative; width: 1.517em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.394em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323508" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.481em;"><span class="texatom" id="MathJax-Span-323509"><span class="mrow" id="MathJax-Span-323510"><span class="mo" id="MathJax-Span-323511" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-323512" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.223em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21929">e^{-1}</script> mod  Φ(n)</li>
<li>ed ≡ 1 mod Φ(n)</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="eanz" id="参数">参数</h4>

<ul data-anchor-id="qou9">
<li>公开参数：大模数n，公钥e</li>
<li>秘密参数：大素数p, q，私钥d</li>
<li>计算私钥：辗转相除 求 ex + ny = 1, x 即为所求</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="i1mm" id="32-加密算法">3.2 加密算法</h3>

<ul data-anchor-id="lexm">
<li>加密(用 e, n) <br>
<ul><li>明文： 0
密文： C ≡ M^e (mod n).</li></ul></li>
<li>解密(用 d, n) <br>
<ul><li>密文： C 明文： M ≡ C^d(mod n)</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="fsc2" id="33-参数要求">3.3 参数要求</h3>

<ul data-anchor-id="4oeu">
<li>模n的长度要求至少是1024比特，甚至2048比特，或更大</li>
<li>|p - q|大</li>
<li>p, q必须是强素数 <br>
<ul><li>p= 2p1+1, q= 2q1+1</li></ul></li>
<li>e为小整数时运算快，但存在问题</li>
<li>d 要大于n^(1/4）</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="gd3p" id="34-简单的分析">3.4 简单的分析</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="6hax" id="341">3.4.1</h4>

<ul data-anchor-id="yk8y">
<li>参数选取不当 <br>
<ul><li>应该是随机素数并且不包含在素数表中</li>
<li>两个素数不应该太接近</li>
<li>选择p和q使其二进制位表示的长度有几比特不同。</li></ul></li>
<li>共模攻击: 指通信系统中使用相同的n，且存在两个用户的公钥e1和e2是互素的，则可以由这两个用户对同一条明文的不同加密结果，恢复出原始 <br>
明文. <br>
<ul><li>不能用同一个n来生成密钥</li></ul></li>
<li>小e攻击:指e很小时，若使用广播加密（即利用同一个e对同一个消息m加密再分发给多个人）下遭遇的攻击.</li>
<li><p>计时攻击:利用指数中某一位为0或者为1时，硬件加密速度不同</p>

<ul><li>不变的幂运算时间：保证所有幂运算中返回结果前执行的时间相同</li>
<li>随机延时</li>
<li>隐蔽：在密文上乘以随机数</li></ul>

<h1 id="lec9-dh密钥交换与elgamal">Lec9 DH密钥交换与ElGamal</h1></li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="8dmn" id="1-基于离散对数的密码">1. 基于离散对数的密码</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="15qr" id="11-diffie-hellman密钥交换">1.1 Diffie-Hellman密钥交换</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="zqwc" id="111-diffie-hellman密钥协商">1.1.1 Diffie-Hellman密钥协商</h4>

<ul data-anchor-id="xiam">
<li>公钥体制的思想来源，但其本身不是公钥加密算法</li>
<li>基于公钥的密钥分配算法 <br>
<ul><li>不可以被用于交换任意消息（不是加密算法）</li>
<li>而是用于建立一对密钥</li>
<li>仅交互双方知道密钥</li></ul></li>
<li>密钥的值依赖于双方参与者的公开信息和私有信息</li>
<li>安全性依赖于离散对数问题的困难性</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="r24k" id="112-密钥交换算法">1.1.2 密钥交换算法</h4>

<ul data-anchor-id="hvzy">
<li>初始化 <br>
<ul><li>用户得到全局参数 <br>
<ol><li>大素数p</li>
<li>模p的原根g (保证指数唯一性)</li></ol></li>
<li>各个用户（如： Alice）生成各自的公私钥对 <br>
<ol><li>选择私钥：正整数 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21930-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323513" style="width: 1.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.77em 1000em 2.662em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323514"><span class="msubsup" id="MathJax-Span-323515"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323516" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.194em; left: 0.577em;"><span class="mi" id="MathJax-Span-323517" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.273em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21930">x_A</script>&lt; p</li>
<li>计算公钥：<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21931-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323518" style="width: 5.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.942em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.536em 1000em 2.74em -0.412em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323519"><span class="msubsup" id="MathJax-Span-323520"><span style="display: inline-block; position: relative; width: 1.127em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323521" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.523em;"><span class="mi" id="MathJax-Span-323522" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323523" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="msubsup" id="MathJax-Span-323524" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323525" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.58em;"><span class="texatom" id="MathJax-Span-323526"><span class="mrow" id="MathJax-Span-323527"><span class="msubsup" id="MathJax-Span-323528"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323529" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.241em; left: 0.433em;"><span class="mi" id="MathJax-Span-323530" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.316em; vertical-align: -0.375em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21931">y_A ≡ g^{x_A} </script>(mod p)</li></ol></li>
<li>各个用户公开自己的公钥</li></ul></li>
<li>密钥交换 <br>
<ul><li>适用于参与者为2个的情形（双方密钥交换），假设参与者为Alice和Bob</li>
<li>Alice用自己的私钥和Bob的公钥计算</li>
<li>Bob用自己的私钥和Alice的公钥计算</li>
<li>则有 <br>
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21932-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323531" style="width: 4.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.702em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.44em 1000em 2.819em -0.402em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323532"><span class="mi" id="MathJax-Span-323533" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-323534" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="msubsup" id="MathJax-Span-323535" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323536" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(3.534em 1000em 4.249em -0.408em); top: -4.449em; left: 0.581em;"><span class="texatom" id="MathJax-Span-323537"><span class="mrow" id="MathJax-Span-323538"><span class="msubsup" id="MathJax-Span-323539"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323540" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.241em; left: 0.433em;"><span class="mi" id="MathJax-Span-323541" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.408em); top: -2.037em; left: 0.523em;"><span class="mi" id="MathJax-Span-323542" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.542em; vertical-align: -0.477em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21932">K ≡ y_B^{x_A} </script>(mod p) <br>
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21933-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323543" style="width: 5.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.038em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.406em 1000em 2.842em -0.402em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323544"><span class="msup" id="MathJax-Span-323545"><span style="display: inline-block; position: relative; width: 1.243em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323546" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.766em; left: 0.975em;"><span class="mo" id="MathJax-Span-323547" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323548" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="msubsup" id="MathJax-Span-323549" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323550" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(3.534em 1000em 4.241em -0.408em); top: -4.441em; left: 0.581em;"><span class="texatom" id="MathJax-Span-323551"><span class="mrow" id="MathJax-Span-323552"><span class="msubsup" id="MathJax-Span-323553"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323554" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.433em;"><span class="mi" id="MathJax-Span-323555" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(1.705em 1000em 2.5em -0.408em); top: -2.014em; left: 0.523em;"><span class="mi" id="MathJax-Span-323556" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.617em; vertical-align: -0.507em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21933">K' ≡ y_A^{x_B} </script>(mod p) <br>
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21934-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323557" style="width: 19.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.192em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.406em 1000em 2.819em -0.402em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323558"><span class="mi" id="MathJax-Span-323559" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-323560" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="msubsup" id="MathJax-Span-323561" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323562" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; clip: rect(3.534em 1000em 4.249em -0.408em); top: -4.449em; left: 0.581em;"><span class="texatom" id="MathJax-Span-323563"><span class="mrow" id="MathJax-Span-323564"><span class="msubsup" id="MathJax-Span-323565"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323566" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.241em; left: 0.433em;"><span class="mi" id="MathJax-Span-323567" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.408em); top: -2.037em; left: 0.523em;"><span class="mi" id="MathJax-Span-323568" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323569" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="mo" id="MathJax-Span-323570" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-323571"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323572" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.58em;"><span class="texatom" id="MathJax-Span-323573"><span class="mrow" id="MathJax-Span-323574"><span class="msubsup" id="MathJax-Span-323575"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323576" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.433em;"><span class="mi" id="MathJax-Span-323577" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-323578"><span style="display: inline-block; position: relative; width: 1.33em; height: 0px;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.378em); top: -2.356em; left: 0em;"><span class="mo" id="MathJax-Span-323579" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.385em;"><span class="texatom" id="MathJax-Span-323580"><span class="mrow" id="MathJax-Span-323581"><span class="msubsup" id="MathJax-Span-323582"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323583" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.241em; left: 0.433em;"><span class="mi" id="MathJax-Span-323584" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-323585" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="mo" id="MathJax-Span-323586" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-323587"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323588" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.58em;"><span class="texatom" id="MathJax-Span-323589"><span class="mrow" id="MathJax-Span-323590"><span class="msubsup" id="MathJax-Span-323591"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323592" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.241em; left: 0.433em;"><span class="mi" id="MathJax-Span-323593" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-323594"><span style="display: inline-block; position: relative; width: 1.33em; height: 0px;"><span style="position: absolute; clip: rect(1.462em 1000em 2.75em -0.378em); top: -2.356em; left: 0em;"><span class="mo" id="MathJax-Span-323595" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.385em;"><span class="texatom" id="MathJax-Span-323596"><span class="mrow" id="MathJax-Span-323597"><span class="msubsup" id="MathJax-Span-323598"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.899em 1000em 2.508em -0.408em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323599" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.433em;"><span class="mi" id="MathJax-Span-323600" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-323601" style="font-family: MathJax_Main; padding-left: 0.278em;">≡</span><span class="msup" id="MathJax-Span-323602" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.243em; height: 0px;"><span style="position: absolute; clip: rect(1.529em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323603" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.766em; left: 0.975em;"><span class="mo" id="MathJax-Span-323604" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.587em; vertical-align: -0.477em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21934">K ≡ y_B^{x_A} ≡ (g^{x_B})^{x_A} ≡ (g^{x_A})^{x_B} ≡ K' </script>(mod p) </li>
<li>所得到的K=K’作为Alice和Bob的会话密钥，用于私钥加密算法</li>
<li>攻击者如果想从Alice或Bob的公钥中求出会话密钥K，必须解离散对数问题</li></ul></li>
<li>攻击方法：中间人攻击</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="ptmu" id="12-elgamal公钥加密算法">1.2 ElGamal公钥加密算法</h3>

<p data-anchor-id="u4lp"><img src="http://i58.tinypic.com/2ypfzvq.png" alt="ELgamml" title=""></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="ggey" id="2-椭圆曲线密码学ecc">2. 椭圆曲线密码学（ECC）</h2>

<p data-anchor-id="ix8v">设a,b为实数，方程 <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21935-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323605" style="width: 9.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.212em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.378em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323606"><span class="msubsup" id="MathJax-Span-323607"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323608" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.581em;"><span class="mn" id="MathJax-Span-323609" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323610" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-323611" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323612" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.577em;"><span class="mn" id="MathJax-Span-323613" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323614" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-323615" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">a</span><span class="mi" id="MathJax-Span-323616" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-323617" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-323618" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.475em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21935">y^2 = x^3 + ax + b</script> 的所有实数解(x， y)组成的集合E，加上一个无穷远点O，组成了一个椭圆曲线。此外，要求<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21936-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323619" style="width: 8.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.442em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.32em 1000em 2.715em -0.405em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323620"><span class="mn" id="MathJax-Span-323621" style="font-family: MathJax_Main;">4</span><span class="msubsup" id="MathJax-Span-323622"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.51em -0.4em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323623" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.719em; left: 0.529em;"><span class="mn" id="MathJax-Span-323624" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323625" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-323626" style="font-family: MathJax_Main; padding-left: 0.222em;">27</span><span class="msubsup" id="MathJax-Span-323627"><span style="display: inline-block; position: relative; width: 0.892em; height: 0px;"><span style="position: absolute; clip: rect(1.518em 1000em 2.511em -0.393em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323628" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.777em; left: 0.433em;"><span class="mn" id="MathJax-Span-323629" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323630" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mn" id="MathJax-Span-323631" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.564em; vertical-align: -0.342em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21936">4a^3+27b^2≠0</script> ，确保方程的三个解是不同的，所得的椭圆曲线称为非奇异椭圆曲线。</p>

<p data-anchor-id="7pjb">困难问题：给定点P，从倍点kP求k。</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="6rlw" id="211-椭圆曲线上的运算">2.1.1 椭圆曲线上的运算</h3>

<ul data-anchor-id="7qbv">
<li>E上定义二元运算，使其成为一个Abel群，这个二元运算通常用加法表示</li>
<li>单位元是无穷远点O: P+O=O+P=P</li>
<li>P， Q∈E， P= （x1， y1）， Q=（x2， y2） <br>
<ul><li>P,Q两点的连线L， L与E相交于点R’， P+Q定义为 R=-R’。其几何意义为: <br>
• 如果x1≠ x2， P+Q=R：是P和Q连线L与E的交点关于x轴的对称点 <br>
• 如果x1=x2， y1=-y2 ， P+Q=O，即无穷远点 <br>
• 如果x1= x2， y1= y2，P+Q=2P：是过P的E的切线与E的焦点关于x轴的对称点</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="8z37" id="212-无穷远点">2.1.2 无穷远点</h3>

<ul data-anchor-id="d337">
<li>平行直线的交点为无穷远点，记做P∞</li>
<li>直线L上的无穷远点只能有一个</li>
<li>平面上一组相互平行的直线有公共的无穷远点。</li>
<li>平面上任何相交的两直线L1,L2有不同的无穷远点。</li>
<li>平面上全体无穷远点构成一条无穷远直线。</li>
<li>平面上全体无穷远点与全体平常点构成射影平面</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="3ei0" id="213-pq-运算">2.1.3 P+Q 运算</h3>

<p data-anchor-id="1s8e">设P = （<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21937-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323632" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.77em 1000em 2.74em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323633"><span class="msubsup" id="MathJax-Span-323634"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323635" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.577em;"><span class="mn" id="MathJax-Span-323636" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323637" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323638" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323639" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.523em;"><span class="mn" id="MathJax-Span-323640" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.375em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21937">x_1, y_1</script>）, Q = (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21938-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323641" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.77em 1000em 2.74em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323642"><span class="msubsup" id="MathJax-Span-323643"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323644" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.577em;"><span class="mn" id="MathJax-Span-323645" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323646" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323647" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323648" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.523em;"><span class="mn" id="MathJax-Span-323649" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.375em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21938">x_2, y_2</script>) ，这里假设<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21939-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323650" style="width: 8.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.538em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.496em 1000em 2.74em -0.412em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323651"><span class="msubsup" id="MathJax-Span-323652"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323653" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.523em;"><span class="mn" id="MathJax-Span-323654" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323655" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="mn" id="MathJax-Span-323656" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-323657" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323658" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323659" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.577em;"><span class="mn" id="MathJax-Span-323660" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323661" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="msubsup" id="MathJax-Span-323662" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323663" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.577em;"><span class="mn" id="MathJax-Span-323664" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.368em; vertical-align: -0.375em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21939">y_1 ≠ 0 , x_1 ≠ x_2</script> 则P+Q = (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21940-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323665" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.452em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.77em 1000em 2.756em -0.398em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323666"><span class="msubsup" id="MathJax-Span-323667"><span style="display: inline-block; position: relative; width: 1.037em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.511em -0.398em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323668" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.577em;"><span class="mn" id="MathJax-Span-323669" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323670" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323671" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.412em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323672" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.523em;"><span class="mn" id="MathJax-Span-323673" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.032em; vertical-align: -0.395em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21940">x_3, y_3</script>)</p>

<p data-anchor-id="hji8"><img src="http://i57.tinypic.com/2qtx0ew.png" alt="p+q" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="g3ct" id="214-ef上离散对数问题">2.1.4 E(F)上离散对数问题</h3>

<ul data-anchor-id="u5ao">
<li>ECC加法类似模乘</li>
<li>ECC累加运算类似模指数运算</li>
<li>ECC指数上的加法运算为模加</li>
<li>ECC上的困难问题等价于离散对数问题，称为椭圆曲线离散对数问题</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="gdy9" id="21-椭圆曲线密码">2.1 椭圆曲线密码</h3>

<p data-anchor-id="vkn1">椭圆曲线可以用较短的参数长度实现同样的安全级别</p>

<p data-anchor-id="tj3e">不会了。。</p>

<div class="md-section-divider"></div>

<h1 data-anchor-id="dnnu" id="lec10-hash函数和消息认证">Lec10 Hash函数和消息认证</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="8gn2" id="1-消息认证和认证函数">1. 消息认证和认证函数</h2>

<p data-anchor-id="55uy">消息认证：验证所收到的消息确实是来自真正的发送方，且未被修改。可以看作两层： (1) 产生消息认证符的函数 (2) 使用认证函数作为原语来验证消息真实性的协议</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="lum6" id="11-认证系统">1.1 认证系统</h3>

<p data-anchor-id="k0zi"><img src="http://i57.tinypic.com/30ken9v.png" alt="认证系统" title=""></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="cqqb" id="2-认证函数">2. 认证函数</h2>

<ul data-anchor-id="k2hv">
<li>报文加密 <br>
以整个报文的密文为认证码</li>
<li>报文认证码(MAC) <br>
以一个报文的公共函数和用于产生一个定长值的密钥作为认证符</li>
<li>散列函数 <br>
一个将任意长度的报文映射为定长的散列值的公共函数,以散列值作为认证符</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="ukx2" id="21-报文加密">2.1 报文加密</h3>

<ul data-anchor-id="ii2e">
<li>对称加密 <br>
<ul><li>提供保密(仅A和B共享密钥K)</li>
<li>提供一定程度的认证 <br>
<ol><li>需要某种结构或冗余,以识别合法明文</li></ol></li>
<li>不提供签名 <br>
<ol><li>接收者可以伪造报文</li>
<li>发送者可以否认报文</li></ol></li></ul></li>
<li>公钥加密 <br>
发送方先用自己的私钥签名消息以提供认证,然后使用接收方公钥加密消息提供保密性。缺点是效率不高。一种解决方法为“签密”</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="g4cc" id="22-散列函数hash">2.2 散列函数hash</h3>

<ul data-anchor-id="920l">
<li>散列函数是将任意长度的消息映射成一个较短的定长输出消息的函数.</li>
<li>散列函数的目的是为文件、报文或其它的分组数据产生“数字指纹”</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="qwu1" id="221-散列函数消息认证方式">2.2.1 散列函数消息认证方式</h4>

<ol data-anchor-id="630w">
<li>假设A和B共享密钥K。 A向B发送: Ek(M || H(M) )</li>
<li>假设A和B共享密钥K。 A向B发送: M || Ek(H(M))</li>
<li>假设A的公私钥对为{PKa,SKa}， A向B发送: M || Sig（SKa）(H(M) )</li>
<li>假设A的公私钥对为{PKa,SKa}， A和B共享会话密钥k <br>
<ul><li>A向B发送： Ek(M ||Sig（SKa）( H(M) ) )</li></ul></li>
<li>该方法不使用加密函数。但假设A和B共享某秘密S <br>
<ul><li>A向B发送: M || H(M || S)</li></ul></li>
<li>在方法五中加入对称加密</li>
</ol>

<div class="md-section-divider"></div>

<h4 data-anchor-id="51pw" id="222-散列函数的特点">2.2.2 散列函数的特点</h4>

<ul data-anchor-id="c8dq">
<li>单向性：对任意给定的码h, 寻求x使得H(x)=h在计算上是不可行的</li>
<li>弱抗碰撞性：任意给定消息x, 寻求不等于x的y, 使得H(y)= H(x)在计算上不可行</li>
<li>强抗碰撞性：寻求对任何的(x,y)对使得H(x)=H(y)在计算上不可行</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="fekx" id="223-碰撞攻击">2.2.3 碰撞攻击</h4>

<ul data-anchor-id="rf5c">
<li><p>对于均匀分布的0到N-1的范围内选择随机整数变量，那么在N^(1/2)次选择后发生重复的概率就会超过1/2.因此对于m位的hash值，如果随机选择数据块， 预计在(2^m)^(1/2) = 2^(m/2) 次尝试后就将找到两个具有相同hash值的数据块。</p></li>
<li><p>简单的说，对输出长度为m的Hash函数，值2^(m/2)决定了该Hash函数抗穷举攻击的能力</p></li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="7ypc" id="224-md5散列算法">2.2.4 MD5散列算法</h4>

<p data-anchor-id="5y7q"><img src="http://i57.tinypic.com/211tte.png" alt="MD5" title=""></p>

<ul data-anchor-id="w68z">
<li><p>算法描述</p>

<ul><li>输入：任意长度的消息</li>
<li>输出： 128位Hash输出</li>
<li>处理单元：以512位输入数据块为单位</li>
<li>使用了Merkle-Damgard结构</li></ul></li>
<li><p>对MD5算法简要的叙述可以为：MD5以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。</p></li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="csgv" id="225-算法过程">2.2.5 算法过程</h4>

<ol data-anchor-id="fmme">
<li>填充：如果输入信息的长度(bit)对512求余的结果不等于448，就需要填充使得对512求余的结果等于448。填充的方法是填充一个1和n个0。填充完后，信息的长度就为N*512+448(bit)；</li>
<li>记录信息长度：用64位来存储填充前信息长度。这64位加在第一步结果的后面，这样信息长度就变为N*512+448+64=(N+1)*512位。</li>
<li>初始化MD缓冲区。一个128位MD缓冲区用以保存中间和最终散列函数的结果。它可以表示为4个32位的寄存器(A,B,C,D)。寄存器初始化为以下的16进制值。使用低端格式存储。（A=(01234567)16，B=(89ABCDEF)16，C=(FEDCBA98)16，D=..)</li>
<li><p>处理消息块（512位 = 16个32位字）。一个压缩函数是本算法的核心(HMD5)。它包括4轮处理。四轮处理具有相似的结构,但每次使用不同的基本逻辑函数，记为F,G,H,I。每一轮以当前的512位数据块(Yq)和128位缓冲值ABCD作为输入，并修改缓冲值的内容。每次使用64元素表T[1…64]中的四分之一</p>

<pre class="code-black"><code class="code-black">T表，由sin 函数构造而成。 T的第i个元素表示为T[i]，其值等于 2^32*abs(sin(i)),其中i是弧度。由于abs(sin(i))是一个0到1之间的数， T的每一个元素是一个可以表示成32位的整数。T表提供了随机化的32位模板， 消除了在输入数据中的任何规律性的特征
</code></pre></li>
<li><p>输出结果。所有L个512位数据块处理完毕后，最后的结果就是128位消息摘要    </p></li>
</ol>

<div class="md-section-divider"></div>

<h4 data-anchor-id="w2m2" id="226-单步md5">2.2.6 单步MD5</h4>

<p data-anchor-id="wbi0"><img src="http://i61.tinypic.com/2nbx5cl.png" alt="单步MD5" title=""></p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="qsst" id="227-单步sha-1">2.2.7 单步SHA-1</h4>

<p data-anchor-id="i7fu"><img src="http://i61.tinypic.com/z1ipz.png" alt="单步SHA-1" title=""></p>

<div class="md-section-divider"></div>

<h4 data-anchor-id="ii35" id="228-sha-1-md5比较">2.2.8 SHA-1 / MD5比较</h4>

<p data-anchor-id="wgs5"><img src="http://i57.tinypic.com/21eqcsj" alt="MD5比较" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="uhmm" id="23-消息认证码mac">2.3 消息认证码MAC</h3>

<p data-anchor-id="b5su">认证码(MAC,也称密码检验和)，也是一种认证技术 </p>

<ul data-anchor-id="w2hm">
<li>对选定报文M,使用一个密钥K,产生一个短小的定长数据分组,称为认证码MAC,并将它附加在报文中,提供认证功能。</li>
<li>MAC = C_k(M) ,其中M是可变长的报文,K是通信双方共享密钥,Ck(M)是定长的认证码.</li>
<li>不具保密性</li>
<li>不可逆</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="klco" id="231-hmac">2.3.1 HMAC</h4>

<p data-anchor-id="bsxa">First-Hash = H(Ko XOR Ipad || (data to auth)) Second-Hash = H(Ko XOR Opad || First-Hash)</p>

<ol data-anchor-id="jyeg">
<li>在密钥K后面添加0来创建一个字长为B的字符串。(例如，如果K的字长是20字节，B=64字节，则K后会加入44个零字节0x00)</li>
<li>将上一步生成的B字长的字符串与ipad做异或运算。</li>
<li>将数据流text填充至第二步的结果字符串中。</li>
<li>用H作用于第三步生成的数据流。</li>
<li>将第一步生成的B字长字符串与opad做异或运算。</li>
<li>再将第四步的结果填充进第五步的结果中。</li>
<li>用H作用于第六步生成的数据流，输出最终结果</li>
</ol>

<div class="md-section-divider"></div>

<h1 data-anchor-id="4g5d" id="lec11-数字签名及公钥管理">Lec11 数字签名及公钥管理</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="6xj3" id="1-数字签名体制">1. 数字签名体制</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="b4jw" id="11-数字签名">1.1 数字签名</h3>

<p data-anchor-id="huy3">给以电子形式存储的消息进行签名，签名后的消息可以通过计算机网络传输</p>

<ul data-anchor-id="m940">
<li>签署的文件： DS中必须以某种形式将签名“绑”到所签的文件上</li>
<li>使用公开的验证算法验证，“任何人”都能验证签名</li>
<li><p>数字签名文件的copy与原签名文件相同（而仿造的手写签名很容易与原始签名区分开），因此签名文件本身应包含日期等信息</p></li>
<li><p>避免双方相互欺骗</p></li>
<li>假定A发送一个认证的信息给B，双方之间的争议可能有多种形式： <br>
<ul><li>B伪造一个不同的消息，但声称是从A收到的。</li>
<li>A可以否认发过该消息， B无法证明A确实发了该消息</li>
<li>第三方对消息进行篡改</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="zg6c" id="12-数字签名原理">1.2 数字签名原理</h3>

<p data-anchor-id="4329"><img src="http://i59.tinypic.com/bfmbsg.png" alt="SIG" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="9lnh" id="13-数字签名要求">1.3 数字签名要求</h3>

<ul data-anchor-id="apox">
<li>签名必须是依赖于被签名信息的比特模式；</li>
<li>签名必须使用某些发送者独有的信息，以防止双方的伪造与否认；</li>
<li>签名过程及验证过程容易；</li>
<li>伪造该数字签名在计算复杂性意义上具有不可行性 <br>
<ul><li>既包括对一个已有的数字签名构造新的消息</li>
<li>也包括对一个给定消息伪造一个数字签名；</li></ul></li>
<li>在存储器中保存一个数字签名备份是现实可行的</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="4s55" id="14-直接数字签名">1.4 直接数字签名</h3>

<ul data-anchor-id="5eo2">
<li>A→B: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21941-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323674" style="width: 6.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.615em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.851em -0.381em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323675"><span class="mi" id="MathJax-Span-323676" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mi" id="MathJax-Span-323677" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-323678"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323679" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.526em;"><span class="texatom" id="MathJax-Span-323680"><span class="mrow" id="MathJax-Span-323681"><span class="mi" id="MathJax-Span-323682" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="msubsup" id="MathJax-Span-323683"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.411em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323684" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.645em;"><span class="mi" id="MathJax-Span-323685" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323686" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-323687" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-323688" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.557em; vertical-align: -0.519em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21941">Sig_{SK_a}[M]</script> <br>
<ul><li>提供认证及数字签名</li></ul></li>
<li>A→B: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21942-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323689" style="width: 13.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.048em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.462em 1000em 2.851em -0.402em); top: -2.356em; left: 0em;"><span class="mrow" id="MathJax-Span-323690"><span class="msubsup" id="MathJax-Span-323691"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(1.532em 1000em 2.5em -0.402em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323692" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.206em; left: 0.743em;"><span class="mi" id="MathJax-Span-323693" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323694" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323695" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="texatom" id="MathJax-Span-323696"><span class="mrow" id="MathJax-Span-323697"><span class="mo" id="MathJax-Span-323698" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-323699"><span class="mrow" id="MathJax-Span-323700"><span class="mo" id="MathJax-Span-323701" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-323702" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mi" id="MathJax-Span-323703" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-323704"><span style="display: inline-block; position: relative; width: 1.995em; height: 0px;"><span style="position: absolute; clip: rect(1.77em 1000em 2.705em -0.423em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323705" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.115em; left: 0.526em;"><span class="texatom" id="MathJax-Span-323706"><span class="mrow" id="MathJax-Span-323707"><span class="mi" id="MathJax-Span-323708" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="msubsup" id="MathJax-Span-323709"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.729em 1000em 2.5em -0.411em); top: -2.356em; left: 0em;"><span class="mi" id="MathJax-Span-323710" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.645em;"><span class="mi" id="MathJax-Span-323711" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span></span><span class="mo" id="MathJax-Span-323712" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323713" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-323714" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323715" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-323716" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323717" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-323718" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.356em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.557em; vertical-align: -0.519em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21942">E_k( M || Sig_{SK_a}( H(M) ) )</script> <br>
<ul><li>提供认证及数字签名， 保密</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="sysb" id="15-rsa签名">1.5 RSA签名</h3>

<p data-anchor-id="ba0t">RSA签名方案，与RSA加密相反，用d签名，用e验证 <br>
<img src="http://i59.tinypic.com/95rg3o.png" alt="RSA" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="23tn" id="16-数字签名标准dss">1.6 数字签名标准DSS</h3>

<p data-anchor-id="abxm"><img src="http://i61.tinypic.com/2z4xppz.jpg" alt="DSA" title=""></p>

<div class="md-section-divider"></div>

<h2 data-anchor-id="u2wm" id="2-公钥分配途径">2. 公钥分配途径</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="f6u2" id="21-公开发布">2.1 公开发布</h3>

<ul data-anchor-id="9dxm">
<li>任一通信方将公钥发送给另一方或者广播给通信各方。如PGP中用户在给公开论坛发送消息时，将其公钥附加在要发送的消息后。</li>
<li>问题：任何人都可伪造公钥发布过程，直到公钥拥有者发现假冒</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="bbuv" id="22-公开可访问目录">2.2 公开可访问目录</h3>

<ul data-anchor-id="0p3h">
<li>通过在一个公开目录中注册密钥来获得更大的安全性</li>
<li>公开目录必须可信，且具有如下性质 <br>
• 包含目录项 {姓名，公钥} <br>
• 通信成员必须进行过安全注册（亲自 or安全信道） <br>
• 通信成员任何时刻均可更新公钥 <br>
• 目录定期更新 <br>
• 通信方可以访问电子目录</li>
<li>缺点 <br>
• 一旦攻击者获得目录管理员公钥，则可伪造任意通信方 <br>
• 攻击者还可能修改目录管理员保存的记录来达到目标</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="01x0" id="23-公钥授权">2.3 公钥授权</h3>

<ol data-anchor-id="22w3">
<li>A发送带时间戳的消息给公钥管理员，请求B的当前公钥;</li>
<li>管理员用自己的私钥签名一条消息（含B的公钥、A的请求、原始时间戳）给A， A可确认消息来自管理员;</li>
<li>A保存B的公钥，生成一个挑战（临时交互号） ;</li>
<li><ol><li>B用1-2步的方法从公钥管理员处得到A的公钥</li></ol></li>
<li>对A的挑战形成响应，并对A形成新挑战（N2）</li>
<li>A响应B的挑战</li>
</ol>

<hr>

<ul data-anchor-id="glpw">
<li>只能从管理机构获得公钥。公钥管理员成为瓶颈</li>
<li>容易产生DOS攻击</li>
<li>管理机构如何得到A的公钥？</li>
<li>A如何得到管理机构的公钥？</li>
<li>且公钥管理员维护的{姓名,公钥}目录也容易被篡改</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="gsar" id="24-公钥证书">2.4 公钥证书</h3>

<p data-anchor-id="42gk"><img src="http://i61.tinypic.com/16l9ydy.png" alt="此处输入图片的描述" title=""></p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="jwjo" id="25-简单的密钥分配">2.5 简单的密钥分配</h3>

<ol data-anchor-id="4534">
<li>A生成公私钥对{PKA,SKA}，并将PKA和IDA发送给B</li>
<li>B用A的公钥加密会话密钥KS，返回给A</li>
<li>A放弃{PKA,SKA}， B放弃PKA</li>
</ol>

<hr>

<p data-anchor-id="3vxc"><strong>插入攻击</strong> <br>
- 攻击者Malice可以在(1)中用{PKM,IDA}替换{PKA,IDA} <br>
- Malice获得Ks后，用对Ks再次加密，转发给A <br>
- 则A和B均知道Ks，但他们不知道Malice也知道Ks</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="2wdx" id="26-改进版">2.6 改进版</h3>

<p data-anchor-id="83va">具有保密性和真实性的密钥分配</p>

<ol data-anchor-id="ngoy">
<li>A用B的公钥对自己的身份IDA和临时交互号N1加密发送给B</li>
<li>B发送用A的公钥PKA加密的消息，A确认B</li>
<li>A用B的公钥对B的挑战N2进行加密， B确认通信伙伴是A</li>
<li>A选择会话密钥，用自己的私钥SKA对Ks进行签名，再用B的公钥加密。确保只有B才能解密Ks，且只有A能发送该消息</li>
<li>B用自己的私钥解密第4步的消息，得到K</li>
</ol>

<div class="md-section-divider"></div>

<h1 data-anchor-id="nw7r" id="lec-12-认证服务">Lec 12 认证服务</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="g78y" id="0-口令认证">0. 口令认证</h2>

<div class="md-section-divider"></div>

<h2 data-anchor-id="z7go" id="1-keroes">1. Keroes</h2>

<div class="md-section-divider"></div>

<h2 data-anchor-id="e2r8" id="2-x509">2. X.509</h2>

<div class="md-section-divider"></div>

<h1 data-anchor-id="fbhb" id="lec-13-ipwev安全">Lec 13 IP/Wev安全</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="8yp5" id="0-web安全方式">0. Web安全方式</h2>

<ul data-anchor-id="r1ai">
<li>提供Web安全性的一种方法是使用IP安全性（如IPSec协议）。优点在于，对终端用户和应用均是透明的。</li>
<li>另一种解决方法是在TCP上实现安全性。这种方法最先的例子是安全套接层（SSL），接着是安全运输层（TLS）的Internet SSL标准。SSL（TLS）作为基本协议族的一个部分提供，对应用程序透明。或 <br>
是将SSL嵌入专门软件中（如Netscapte和IE浏览器）</li>
<li>特定安全服务在特定应用中的一体现。是为特定应用程序的专门需要定 <br>
制的服务。 如安全电子交易SET，认证协议Kerberos，安全电子邮件协议PGP(个人邮件安全)和S/MIME(工业标准)</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="cawm" id="1-ssl">1. SSL</h2>

<ul data-anchor-id="7uur">
<li>目标:在Browser和Web Server之间提供敏感信息传输通道 <br>
<ul><li>使用TCP提供一个可靠的端到端安全服务，为两个通讯个体之间提供保密性和完整性(身份鉴别)</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="4ig4" id="11-提供服务">1.1 提供服务</h3>

<ol data-anchor-id="0d3r">
<li>认证用户和服务器，确保数据发送到正确的客户机和服务器；</li>
<li>加密数据以防止数据中途被窃取；</li>
<li>维护数据的完整性，确保数据在传输过程中不被改变。</li>
</ol>

<div class="md-section-divider"></div>

<h3 data-anchor-id="yhzm" id="12-体系结构">1.2 体系结构</h3>

<ul data-anchor-id="f10b">
<li>SSL的体系结构中包含两个协议子层，其中底层是SSL纪录协议层（SSL Record Protocol Layer）；高层是SSL握手协议层（SSL HandShake Protocol Layer）</li>
<li>SSL握手协议层包括SSL握手协议（SSL HandShake Protocol）、SSL密码参数修改协议（SSL Change Cipher Spec Protocol）、应用数据协议（Application Data Protocol）和SSL告警协议（SSL Alert Protocol）。握手层的这些协议用于SSL管理信息的交换，允许应用协议传送数据之间相互验证，协商加密算法和生成密钥等。SSL握手协议的作用是协调客户和服务器的状态，使双方能够达到状态的同步。</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="2w0v" id="13-ssl握手协议">1.3 SSL握手协议</h3>

<p data-anchor-id="w2s8">SSL握手协议允许通信实体在交换应用数据之前协商密钥的算法、 加密密钥和对客户端进行认证（可选）的协议，为下一步记录协议要使用的密钥信息进行协商，使客户端和服务器建立并保持安全通信的状态信息。 SSL握手协议是在任何应用程序数据传输之前使用的。</p>

<ul data-anchor-id="lrua">
<li>第一个阶段建立安全能力;</li>
<li>第二个阶段服务器鉴别和密钥交换;</li>
<li>第三个阶段客户鉴别和密钥交换;</li>
<li>第四个阶段完成握手协议。</li>
</ul>

<p data-anchor-id="nwar"><img src="http://i61.tinypic.com/29y5y6u.png" alt="SSL" title=""></p>

<div class="md-section-divider"></div>

<h1 data-anchor-id="k9n4" id="lec14-安全邮件">Lec14 安全邮件</h1>

<div class="md-section-divider"></div>

<h2 data-anchor-id="z1jd" id="0-电子邮件">0. 电子邮件</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="cfht" id="01-mime">0.1 MIME</h3>

<p data-anchor-id="9fue">MIME是 Multipurpose Internet Mail Extensions 的缩写</p>

<ul data-anchor-id="zd78">
<li>说明了如何安排消息格式使消息在不同的邮件系统内进行交换</li>
<li>MIME 的格式灵活，允许邮件中包含任意类型的文件</li>
<li>MIME 消息可以包含文本、图象、声音、视频及其它应用程序的特定数据</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="ce3e" id="02-隐患">0.2 隐患</h3>

<ul data-anchor-id="f7jx">
<li>E-mail是以纯文本方式在internet上传输的，</li>
<li>SMTP不需要身份认证，</li>
<li>POP通讯也只需要口令进行身份认证，也是纯文本的，这些都有可能被截获</li>
<li>保密</li>
<li>完整</li>
<li>真实</li>
<li>不可否认</li>
</ul>

<div class="md-section-divider"></div>

<h2 data-anchor-id="kz60" id="1-pgp">1. PGP</h2>

<div class="md-section-divider"></div>

<h3 data-anchor-id="eamf" id="11-身份认证">1.1 身份认证</h3>

<ul data-anchor-id="1k5c">
<li>发送方 <br>
<ul><li>产生消息M</li>
<li>用SHA-1对M生成一个160位的散列码H</li>
<li>用发送者的私钥对H加密，并与M连接</li></ul></li>
<li>接收方 <br>
<ul><li>用发送者的公钥解密并恢复散列码H</li>
<li>对消息M生成一个新的散列码，与H比较。如果一致，则消息M被鉴别。</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="v1l9" id="12-保密">1.2 保密</h3>

<ul data-anchor-id="gv6n">
<li>发送方 <br>
<ul><li>生成消息M并为该消息生成一个随机数作为会话密钥。</li>
<li>用会话密钥加密M</li>
<li>用接收者的公钥加密会话密钥并与消息M结合</li></ul></li>
<li>接收方 <br>
<ul><li>用自己的私钥解密恢复会话密钥</li>
<li>用会话密钥解密恢复消息M</li>
<li>PGP采用CAST-128(或IDEA或3DES)、64位CFB方式。一次性密钥，单向分发，公钥算法保护。</li>
<li>公开密钥算法的长度决定安全性RSA(768~3072)、 DSS(1024)</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="xpw7" id="13-保密与认证同时">1.3 保密与认证同时</h3>

<p data-anchor-id="7suz">发送者先用自己的私钥签名，然后用会话密钥加密，再用接收者的公钥加密 <br>
会话密钥。</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="bs5o" id="14-数据压缩">1.4 数据压缩</h3>

<ul data-anchor-id="m4yk">
<li>压缩的位置：发生在签名后、加密前。</li>
<li>压缩之前生成签名： <br>
<ul><li>验证时无须压缩</li>
<li>压缩算法的多样性</li></ul></li>
<li>在加密前压缩：压缩的报文更难分析</li>
<li>对邮件传输或存储都有节省空间的好处</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="k415" id="15-pgp密钥">1.5 PGP密钥</h3>

<ul data-anchor-id="ve83">
<li><p>一次性会话常规密钥，使用四种类型的密钥：</p>

<ul><li>公钥，私钥，基于口令短语的常规密钥</li></ul></li>
<li><p>对密钥的需求“密钥环”：</p>

<ol><li>需要一种生成不可预知的会话密钥的手段</li>
<li>需要某种手段来标识具体的密钥。一个用户拥有多个公钥/私钥对。（更换，分组）</li>
<li>每个PGP实体需要维护一个文件保存其公钥私钥对，和一个文件保存通信对方的公</li></ol></li>
<li><p>键盘输入时间和内容用来产生随机流。</p></li>
</ul>

<hr>

<p data-anchor-id="tb8w">一个用户有多个公钥/私钥对时，接收者如何知道发送者是用了哪个公钥来加密会话密钥？</p>

<ul data-anchor-id="z4d6">
<li>将公钥与消息一起传送。</li>
<li>将一个标识符与一个公钥关联。对一个用户来说做到一一对应。</li>
<li>定义KeyID 包括64个有效位： (KUa mod 264)</li>
<li>KeyID同样也需要PGP数字签名。</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="jgkr" id="16-发送格式">1.6 发送格式</h3>

<p data-anchor-id="sgwq">会话秘钥+签名+报文</p>

<div class="md-section-divider"></div>

<h3 data-anchor-id="p1qu" id="17-私钥公钥环">1.7 私钥公钥环</h3>

<ul data-anchor-id="3cxz">
<li>PGP在每一个节点上提供一对数据结构： <br>
<ul><li>存储该节点拥有的公钥/私钥对； （私钥环）</li>
<li>存储本节点知道的其他用户的公钥；（公钥环） <br>
• 多个UserID可以对应一个公钥</li></ul></li>
<li>UserID：通常是用户的邮件地址。也可以是一个名字，或重用一个名字多次。</li>
<li>Private Key，使用CAST-128(或IDEA或3DES)加密过程： <br>
<ul><li>用户选择一个口令短语用于加密私钥；</li>
<li>当系统用RSA生成一个新的公钥/私钥对时，要求用户输入口令短 <br>
语。对该短语使用SHA-1生成一个160位的散列码后，销毁该短语。</li>
<li>系统用其中128位作为密钥用CAST-128加密私钥，然后销毁这个 <br>
散列码，并将加密后的私钥存储到私钥环中。</li>
<li>当用户要访问私钥环中的私钥时，必须提供口令短语。 PGP将检索出加密的私钥，生成散列码，解密私钥</li></ul></li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="nk1k" id="18-消息处理">1.8 消息处理</h3>

<div class="md-section-divider"></div>

<h4 data-anchor-id="dwz3" id="181-发送方">1.8.1 发送方</h4>

<ul data-anchor-id="u67t">
<li>签名 ：从私钥环中得到私钥，利用userid作为索引；  <br>
PGP提示输入口令短语，恢复私钥构造签名部分</li>
<li>加密： PGP产生一个会话密钥，并加密消息PGP用接收者userid从公钥环中获取其公钥构造消息的会话密钥部分</li>
</ul>

<div class="md-section-divider"></div>

<h4 data-anchor-id="up9m" id="182-接收方">1.8.2 接收方</h4>

<ul data-anchor-id="736g">
<li>解密： PGP用消息的会话密钥部分中的KeyID作为索引，从私钥环中获取 <br>
私钥PGP提示输入口令短语，恢复私钥PGP恢复会话密钥，并解密消息</li>
<li>验证： PGP用消息的签名部分中的KeyID作为索引，从公钥环中获取发送 <br>
者的公钥PGP恢复被传输过来的消息摘要PGP对于接收到的消息作摘要，并与 <br>
上一步的结果作比较</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="1dr4" id="19-公钥管理">1.9 公钥管理</h3>

<p data-anchor-id="ypyk">证书的获取可以通过下面的方式：</p>

<ul data-anchor-id="bmns">
<li>物理上得到B的公钥。</li>
<li>通过电话验证公钥。 <br>
• B将其公钥email给A， A可以用PGP对该公钥生成一个160位的SHA-1摘要，并 <br>
以16进制显示。这一特点称作密钥的“指纹”。然后A打电话给B，让B在电话 <br>
中对证“指纹”。如果双方一致，则该公钥被认可。</li>
<li>从双方都信任的个体D处获得B的公钥。 <br>
• D是介绍人，生成一个签名的证书。其中包含B的公钥，密钥生成时间。 D对该证书生成一个SHA-1摘要，用其私钥加密这个摘要，并将其附加在证书后。因为只有D能够产生这个签名，没有人可以生成一个错误的公钥并假装是D签名的。这个签名的证书可以由B或D直接发给A，也可以贴到公告牌上。</li>
<li>从一个信任的CA中心得到B的公钥。</li>
</ul>

<div class="md-section-divider"></div>

<h3 data-anchor-id="30wb" id="110-信任关系">1.10 信任关系</h3>

<ul data-anchor-id="f0nc">
<li>Key legitimacy field：表明PGP将信任这是一个对该用户是合法的公钥；信任级别越高，这个userID对这个密钥的绑定越强。这个字段是由PGP计算的。</li>
<li>每一个签名与一个signature trust field关联，表明这个PGP用户对签名人对公钥签名的信任程度。Key legitimacy field 是由多个signature trust field 导出的。</li>
<li>Owner trust field：表明该公钥被信任用于签名其它公钥证书的信 <br>
任程度。这一级别的信任是由用户给出的。</li>
</ul>
</body>
</html>